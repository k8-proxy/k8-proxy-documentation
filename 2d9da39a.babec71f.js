(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{101:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return y})),n.d(t,"metadata",(function(){return w})),n.d(t,"rightToc",(function(){return g})),n.d(t,"default",(function(){return O}));var r=n(2),o=n(6),i=n(0),s=n.n(i),a=n(103),l=n(114),c=n(104),u=n(68),p=n.n(u),d=37,f=39;var b=function(e){var t=e.block,n=e.children,r=e.defaultValue,o=e.values,a=e.groupId,u=e.className,b=Object(l.a)(),h=b.tabGroupChoices,m=b.setTabGroupChoices,y=Object(i.useState)(r),w=y[0],g=y[1],j=Object(i.useState)(!1),O=j[0],v=j[1];if(null!=a){var _=h[a];null!=_&&_!==w&&o.some((function(e){return e.value===_}))&&g(_)}var P=function(e){g(e),null!=a&&m(a,e)},T=[],x=function(e){e.metaKey||e.altKey||e.ctrlKey||v(!0)},k=function(){v(!1)};return Object(i.useEffect)((function(){return window.addEventListener("keydown",x),window.addEventListener("mousedown",k),function(){window.removeEventListener("keydown",x),window.removeEventListener("mousedown",k)}}),[]),s.a.createElement("div",null,s.a.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:Object(c.a)("tabs",{"tabs--block":t},u)},o.map((function(e){var t=e.value,n=e.label;return s.a.createElement("li",{role:"tab",tabIndex:0,"aria-selected":w===t,className:Object(c.a)("tabs__item",p.a.tabItem,{"tabs__item--active":w===t}),style:O?{}:{outline:"none"},key:t,ref:function(e){return T.push(e)},onKeyDown:function(e){!function(e,t,n){switch(n.keyCode){case f:!function(e,t){var n=e.indexOf(t)+1;e[n]?e[n].focus():e[0].focus()}(e,t);break;case d:!function(e,t){var n=e.indexOf(t)-1;e[n]?e[n].focus():e[e.length-1].focus()}(e,t)}}(T,e.target,e),x(e)},onFocus:function(){return P(t)},onClick:function(){P(t),v(!1)},onPointerDown:function(){return v(!1)}},n)}))),s.a.createElement("div",{role:"tabpanel",className:"margin-vert--md"},i.Children.toArray(n).filter((function(e){return e.props.value===w}))[0]))};var h=function(e){return s.a.createElement("div",null,e.children)},m=["components"],y={title:"Python/PHP/JS Code Sample",sidebar_label:"Python/PHP/JS Code Sample"},w={unversionedId:"products/gw cloud sdk/python-sample",id:"products/gw cloud sdk/python-sample",isDocsHomePage:!1,title:"Python/PHP/JS Code Sample",description:"<Tabs",source:"@site/docs/products/gw cloud sdk/python-sample.md",slug:"/products/gw cloud sdk/python-sample",permalink:"/k8-proxy-documentation/docs/products/gw cloud sdk/python-sample",version:"current",sidebar_label:"Python/PHP/JS Code Sample",sidebar:"docs",previous:{title:"Automated Deployment",permalink:"/k8-proxy-documentation/docs/products/gw cloud sdk/deployment"},next:{title:"Upgrading cs-api in an existing deployment",permalink:"/k8-proxy-documentation/docs/products/gw cloud sdk/upgrade"}},g=[{value:"api/rebuild/base64",id:"apirebuildbase64",children:[]},{value:"api/rebuild/file",id:"apirebuildfile",children:[]},{value:"api/rebuild/zipfile",id:"apirebuildzipfile",children:[]},{value:"api/rebuild/base64 using php",id:"apirebuildbase64-using-php",children:[]},{value:"Process File",id:"process-file",children:[]},{value:"Process Zip",id:"process-zip",children:[]},{value:"Process Base64",id:"process-base64",children:[]}],j={rightToc:g};function O(e){var t=e.components,n=Object(o.a)(e,m);return Object(a.b)("wrapper",Object(r.a)({},j,n,{components:t,mdxType:"MDXLayout"}),Object(a.b)(b,{defaultValue:"python",values:[{label:"Python",value:"python"},{label:"PHP",value:"php"},{label:"JavaScript",value:"js"}],mdxType:"Tabs"},Object(a.b)(h,{value:"python",mdxType:"TabItem"},Object(a.b)("h1",{id:"python"},"Python"),Object(a.b)("p",null,"The following code snippets are examples of calling the GW Cloud SDK using Python. The requests library is used to execute calls to the API."),Object(a.b)("h2",{id:"apirebuildbase64"},"api/rebuild/base64"),Object(a.b)("p",null,"In this example, files are loaded from the OS and a request with the content type of 'application/json' is formed. The request is then sent to the API using the POST method.\nThe rebuilt file is returned as Base64, decoded by the client and written to disk."),Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre"},'import base64\nimport requests\n\n\nurl = "https://<host>:<port>/api/rebuild/base64"\n\n""" rebuild a single file using the base64 endpoint.\nallow (0) review comments in microsoft word files """\n\n# open a local file\nwith open("data/doc/embedded_images_12kb.docx", "rb") as f:\n    # convert from bytes to str of base64 string\n    base64_string_input = base64.b64encode(f.read()).decode()\n\n# send post request to /base64 endpoint, returns base64 encoded bytes\nresponse = requests.post(\n    url=url,\n    json={\n        "Base64": base64_string_input\n    }\n)\n\n# convert base64 encoded bytes to string\nbase64_string_output = response.content.decode()\n\n# metadata has been removed, ensure base64 strings are different\nassert base64_string_input != base64_string_output\n\n# decode base64 string to bytes\nsanitised_file_bytes = base64.b64decode(base64_string_output)\n\n# write file locally\nwith open("data/doc/embedded_images_12kb_gwsanitised.docx", "wb") as f:\n')),Object(a.b)("h2",{id:"apirebuildfile"},"api/rebuild/file"),Object(a.b)("p",null,"In this example, the contents of the raw file are uploaded in a body with a content type of 'multipart/form-data'."),Object(a.b)("p",null,"The rebuilt file contents are returned to the client and written to disk."),Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre"},'import json\nimport os\nimport requests\n\nurl = "https://<host>:<port>/api/rebuild/file"\n\n""" rebuild all files in the "data" directory, writing to a new "data_gwsanitised" directory with the same folder structure.\ndisallow (2) excel files that contain macros and don\'t write them to the new directory.\nallow (0) internal and external hyperlinks found in word documents, but sanitise other content\nsanitise (1, default) and write all other files. """\ndirectory = "data"\nfor root, dirs, files in os.walk(directory):\n    for file_ in files:\n        # create input and out file file paths\n        input_file = os.path.join(root, file_)\n        output_file = os.path.join(f"{directory}_gwsanitised", os.path.relpath(input_file, directory))\n        with open(input_file, "rb") as f:\n            # send post request\n            response = requests.post(\n                url=url,\n                files=[("file", f)],\n                headers={                    \n                    "accept": "application/octet-stream"\n                }\n            )\n        if response.status_code == 200 and response.content:\n            # glasswall successfully sanitised this file, write it to the new directory\n            os.makedirs(os.path.dirname(output_file), exist_ok=True)\n            with open(output_file, "wb") as f:\n                f.write(response.content)\n')),Object(a.b)("h2",{id:"apirebuildzipfile"},"api/rebuild/zipfile"),Object(a.b)("p",null,"In this example, the contents of the zip file are uploaded in a body with a content type of 'application/zip'."),Object(a.b)("p",null,"The rebuilt file contents are returned to the client and written to disk."),Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre"},'import json\nimport os\nimport requests\n\nurl = "https://<host>:<port>/api/rebuild/zipfile"\n\n""" rebuild all files in the "data" directory, writing to a new "data_gwsanitised" directory with the same folder structure.\ndisallow (2) excel files that contain macros and don\'t write them to the new directory.\nallow (0) internal and external hyperlinks found in word documents, but sanitise other content\nsanitise (1, default) and write all other files. """\ndirectory = "data"\nfor root, dirs, files in os.walk(directory):\n    for file_ in files:\n        # create input and out file file paths\n        input_file = os.path.join(root, file_)\n        output_file = os.path.join(f"{directory}_gwsanitised", os.path.relpath(input_file, directory))\n        with open(input_file, "rb") as f:\n            # send post request\n            response = requests.post(\n                url=url,\n                files=[("file", f)],\n                headers={     \n                    "content-type":"application/zip",               \n                    "accept": "application/octet-stream"\n                }\n            )\n        if response.status_code == 200 and response.content:\n            # glasswall successfully sanitised this file, write it to the new directory\n            os.makedirs(os.path.dirname(output_file), exist_ok=True)\n            with open(output_file, "wb") as f:\n                f.write(response.content)\n'))),Object(a.b)(h,{value:"php",mdxType:"TabItem"},Object(a.b)("h1",{id:"php"},"PHP"),Object(a.b)("p",null,"The following code snippets are examples of calling the GW Cloud SDK using php. The requests library is used to execute calls to the API."),Object(a.b)("h2",{id:"apirebuildbase64-using-php"},"api/rebuild/base64 using php"),Object(a.b)("p",null,"In this example, files are loaded from the OS and a request with the content type of 'application/json' is formed. The request is then sent to the API using the POST method."),Object(a.b)("p",null,"The rebuilt file is returned as Base64, decoded by the client and written to disk."),Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre"},'<?php\n$jwt_token = "YOUR_JWT_TOKEN";\nurl = "https://<host>:<port>/api/rebuild/base64"\n// local file\n$Input_File = \'YOUR/INPUT/FILE.docx\';\n$output_file_path = "YOUR/OUTPUT/FILE.docx";\n// convert base64 encoded bytes to string\n$base64 = base64_encode(file_get_contents($Input_File));\n$data = [\n    \'Base64\' => $base64\n   ];\n$json_data = json_encode($data);\n// create  context \n$context = stream_context_create([\n    \'http\' => [\n        \'method\' => \'POST\',\n        \'header\' => "Authorization: " . $jwt_token . "\\r\\n" .\n            "Content-type: application/json\\r\\n" .\n            "Accept: application/json\\r\\n" .\n            "Connection: close\\r\\n" .\n            "Content-length: " . strlen($json_data) . "\\r\\n",\n        \'content\' => $json_data\n    ],\n\n]);\n//Send a file to Glasswall\'s GW Cloud SDK  endpoint, returns base64 encoded bytes\n$response = file_get_contents($url, false, $context);\nif ($response === false) {\n    exit("Unable to get data at $url");\n}\n//decode base64 string to bytes\n$base64_string_output = base64_decode($response);\n//save file to local\nif (file_put_contents($output_file_path, $base64_string_output)) {\n    echo "File downloaded successfully";\n} else {\n    echo "File downloading failed.";\n}\n'))),Object(a.b)(h,{value:"js",mdxType:"TabItem"},Object(a.b)("h1",{id:"javascript"},"JavaScript"),Object(a.b)("p",null," The following code snippets are examples of calling the GW Cloud SDK using JavaScript. The requests library is used to execute calls to the API."),Object(a.b)("h2",{id:"process-file"},"Process File"),Object(a.b)("p",null,"In this example, files are loaded from the OS and a request with the content type of \u2018application/json\u2019 is formed. The request is then sent to the API using the POST method.\nThe rebuilt file is returned as a file, decoded by the client and written to disk."),Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre",className:"language-const",metastring:"fs = require('fs');",fs:!0,"":"","require('fs');":!0},"const request = require('request');\n\nconst apiUrl = 'https://<host>:<port>/api/rebuild/file';\nconst inputFilePath = './data/gw.pdf';\nconst cleanFilePath = './data/clean.pdf';\n\nconst processFile = async () => {\n    return new Promise(function (resolve, reject) {\n        const options = {\n            method: \"POST\",\n            url: apiUrl,\n            headers: {\n                \"Content-Type\": \"multipart/form-data\"\n            },\n            formData: {\n                \"file\": fs.createReadStream(inputFilePath)\n            },\n            encoding: null\n        };\n\n        request(options, function (err, res, response) {\n            if (!err && res.statusCode == 200) {\n                fs.writeFileSync(cleanFilePath, response);\n                resolve(true);\n            } else {\n                reject(err);\n            }\n        });\n    });\n}\n\nmodule.exports = { processFile };\n")),Object(a.b)("h2",{id:"process-zip"},"Process Zip"),Object(a.b)("p",null,"In this example, files are loaded from the OS and a request with the content type of \u2018application/json\u2019 is formed. The request is then sent to the API using the POST method.\nThe rebuilt file is returned as zip file, decoded by the client and written to disk."),Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre"},"const fs = require('fs');\nconst request = require('request');\n\nconst apiUrl = 'https://<host>:<port>/api/rebuild/zipfile';\nconst inputFilePath = './data/gw.zip';\nconst cleanFilePath = './data/clean.zip';\n\nconst processZip = async () => {\n    return new Promise(function (resolve, reject) {\n        const options = {\n            method: \"POST\",\n            url: apiUrl,\n            headers: {\n                \"Content-Type\": \"multipart/form-data\"\n            },\n            formData: {\n                \"file\": fs.createReadStream(inputFilePath)\n            },\n            encoding: null\n        };\n\n        request(options, function (err, res, response) {\n            if (!err && res.statusCode == 200) {\n                fs.writeFileSync(cleanFilePath, response);\n                resolve(true);\n            } else {\n                reject(err);\n            }\n        });\n    });\n}\n\nmodule.exports = { processZip };\n")),Object(a.b)("h2",{id:"process-base64"},"Process Base64"),Object(a.b)("p",null,"In this example, files are loaded from the OS and a request with the content type of \u2018application/json\u2019 is formed. The request is then sent to the API using the POST method.\nThe rebuilt file is returned as Base64, decoded by the client and written to disk."),Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre"},"const fs = require('fs');\nconst request = require('request');\n\nconst apiUrl = 'https://<host>:<port>/api/rebuild/base64';\nconst inputFilePath = './data/gw.pdf';\nconst cleanFilePath = './data/clean.pdf';\n\nconst processBase64 = async () => {\n    return new Promise(function (resolve, reject) {\n        const contents = fs.readFileSync(inputFilePath, { encoding: 'base64' });\n        const options = {\n            method: \"POST\",\n            url: apiUrl,\n            headers: {\n                \"Content-Type\": \"application/json\"\n            },\n            body: {\n                base64: contents\n            },\n            json: true\n        };\n\n        request(options, function (err, res, response) {\n            if (!err && res.statusCode == 200) {\n                fs.writeFileSync(cleanFilePath, response, { encoding: 'base64' });\n                resolve(true);\n            } else {\n                reject(err);\n            }\n        });\n    });\n}\n\nmodule.exports = { processBase64 };\n")))))}O.isMDXComponent=!0},103:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return b}));var r=n(0),o=n.n(r);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var c=o.a.createContext({}),u=function(e){var t=o.a.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},p=function(e){var t=u(e.components);return o.a.createElement(c.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return o.a.createElement(o.a.Fragment,{},t)}},f=o.a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),p=u(n),f=r,b=p["".concat(s,".").concat(f)]||p[f]||d[f]||i;return n?o.a.createElement(b,a(a({ref:t},c),{},{components:n})):o.a.createElement(b,a({ref:t},c))}));function b(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,s=new Array(i);s[0]=f;var a={};for(var l in t)hasOwnProperty.call(t,l)&&(a[l]=t[l]);a.originalType=e,a.mdxType="string"==typeof e?e:r,s[1]=a;for(var c=2;c<i;c++)s[c]=n[c];return o.a.createElement.apply(null,s)}return o.a.createElement.apply(null,n)}f.displayName="MDXCreateElement"},104:function(e,t,n){"use strict";function r(e){var t,n,o="";if("string"==typeof e||"number"==typeof e)o+=e;else if("object"==typeof e)if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(n=r(e[t]))&&(o&&(o+=" "),o+=n);else for(t in e)e[t]&&(o&&(o+=" "),o+=t);return o}t.a=function(){for(var e,t,n=0,o="";n<arguments.length;)(e=arguments[n++])&&(t=r(e))&&(o&&(o+=" "),o+=t);return o}},114:function(e,t,n){"use strict";var r=n(0),o=n(115);t.a=function(){var e=Object(r.useContext)(o.a);if(null==e)throw new Error("`useUserPreferencesContext` is used outside of `Layout` Component.");return e}},115:function(e,t,n){"use strict";var r=n(0),o=Object(r.createContext)(void 0);t.a=o}}]);