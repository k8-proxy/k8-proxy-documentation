(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{100:function(e,n,t){"use strict";function r(e){var n,t,o="";if("string"==typeof e||"number"==typeof e)o+=e;else if("object"==typeof e)if(Array.isArray(e))for(n=0;n<e.length;n++)e[n]&&(t=r(e[n]))&&(o&&(o+=" "),o+=t);else for(n in e)e[n]&&(o&&(o+=" "),o+=n);return o}n.a=function(){for(var e,n,t=0,o="";t<arguments.length;)(e=arguments[t++])&&(n=r(e))&&(o&&(o+=" "),o+=n);return o}},110:function(e,n,t){"use strict";var r=t(0),o=t(111);n.a=function(){var e=Object(r.useContext)(o.a);if(null==e)throw new Error("`useUserPreferencesContext` is used outside of `Layout` Component.");return e}},111:function(e,n,t){"use strict";var r=t(0),o=Object(r.createContext)(void 0);n.a=o},97:function(e,n,t){"use strict";t.r(n),t.d(n,"frontMatter",(function(){return m})),t.d(n,"metadata",(function(){return y})),t.d(n,"rightToc",(function(){return w})),t.d(n,"default",(function(){return j}));var r=t(2),o=t(6),i=t(0),s=t.n(i),a=t(99),l=t(110),c=t(100),p=t(68),u=t.n(p),d=37,f=39;var b=function(e){var n=e.block,t=e.children,r=e.defaultValue,o=e.values,a=e.groupId,p=e.className,b=Object(l.a)(),h=b.tabGroupChoices,m=b.setTabGroupChoices,y=Object(i.useState)(r),w=y[0],g=y[1],j=Object(i.useState)(!1),O=j[0],v=j[1];if(null!=a){var _=h[a];null!=_&&_!==w&&o.some((function(e){return e.value===_}))&&g(_)}var P=function(e){g(e),null!=a&&m(a,e)},x=[],T=function(e){e.metaKey||e.altKey||e.ctrlKey||v(!0)},k=function(){v(!1)};return Object(i.useEffect)((function(){return window.addEventListener("keydown",T),window.addEventListener("mousedown",k),function(){window.removeEventListener("keydown",T),window.removeEventListener("mousedown",k)}}),[]),s.a.createElement("div",null,s.a.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:Object(c.a)("tabs",{"tabs--block":n},p)},o.map((function(e){var n=e.value,t=e.label;return s.a.createElement("li",{role:"tab",tabIndex:0,"aria-selected":w===n,className:Object(c.a)("tabs__item",u.a.tabItem,{"tabs__item--active":w===n}),style:O?{}:{outline:"none"},key:n,ref:function(e){return x.push(e)},onKeyDown:function(e){!function(e,n,t){switch(t.keyCode){case f:!function(e,n){var t=e.indexOf(n)+1;e[t]?e[t].focus():e[0].focus()}(e,n);break;case d:!function(e,n){var t=e.indexOf(n)-1;e[t]?e[t].focus():e[e.length-1].focus()}(e,n)}}(x,e.target,e),T(e)},onFocus:function(){return P(n)},onClick:function(){P(n),v(!1)},onPointerDown:function(){return v(!1)}},t)}))),s.a.createElement("div",{role:"tabpanel",className:"margin-vert--md"},i.Children.toArray(t).filter((function(e){return e.props.value===w}))[0]))};var h=function(e){return s.a.createElement("div",null,e.children)},m={title:"Python/PHP Code Sample",sidebar_label:"Python/PHP Code Sample"},y={unversionedId:"products/gw cloud sdk/python-sample",id:"products/gw cloud sdk/python-sample",isDocsHomePage:!1,title:"Python/PHP Code Sample",description:"<Tabs",source:"@site/docs/products/gw cloud sdk/python-sample.md",slug:"/products/gw cloud sdk/python-sample",permalink:"/k8-proxy-documentation/docs/products/gw cloud sdk/python-sample",version:"current",sidebar_label:"Python/PHP Code Sample",sidebar:"docs",previous:{title:"Automated Deployment",permalink:"/k8-proxy-documentation/docs/products/gw cloud sdk/deployment"},next:{title:"GW Desktop App",permalink:"/k8-proxy-documentation/docs/products/gw desktop app/overview"}},w=[{value:"api/rebuild/base64",id:"apirebuildbase64",children:[]},{value:"api/rebuild/file",id:"apirebuildfile",children:[]},{value:"api/rebuild/zipfile",id:"apirebuildzipfile",children:[]},{value:"api/rebuild/base64 using php",id:"apirebuildbase64-using-php",children:[]},{value:"Process File",id:"process-file",children:[]},{value:"Process Zip",id:"process-zip",children:[]},{value:"Process Base64",id:"process-base64",children:[]}],g={rightToc:w};function j(e){var n=e.components,t=Object(o.a)(e,["components"]);return Object(a.b)("wrapper",Object(r.a)({},g,t,{components:n,mdxType:"MDXLayout"}),Object(a.b)(b,{defaultValue:"python",values:[{label:"Python",value:"python"},{label:"PHP",value:"php"},{label:"JS",value:"js"}],mdxType:"Tabs"},Object(a.b)(h,{value:"python",mdxType:"TabItem"},Object(a.b)("h1",{id:"python"},"Python"),Object(a.b)("p",null,"The following code snippets are examples of calling the GW Cloud SDK using Python. The requests library is used to execute calls to the API."),Object(a.b)("h2",{id:"apirebuildbase64"},"api/rebuild/base64"),Object(a.b)("p",null,"\u200bIn this example, files are loaded from the OS and a request with the content type of 'application/json' is formed. The request is then sent to the API using the POST method.\nThe rebuilt file is returned as Base64, decoded by the client and written to disk."),Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre"},'import base64\nimport requests\n\u200b\n\u200b\nurl = "https://<host>:<port>/api/rebuild/base64"\n\u200b\n""" rebuild a single file using the base64 endpoint.\nallow (0) review comments in microsoft word files """\n\u200b\n# open a local file\nwith open("data/doc/embedded_images_12kb.docx", "rb") as f:\n    # convert from bytes to str of base64 string\n    base64_string_input = base64.b64encode(f.read()).decode()\n\u200b\n# send post request to /base64 endpoint, returns base64 encoded bytes\nresponse = requests.post(\n    url=url,\n    json={\n        "Base64": base64_string_input,\n        "ContentManagementFlags": {\n            "WordContentManagement": {\n                "ReviewComments": 0,\n            }\n        }\n    }\n)\n\u200b\n# convert base64 encoded bytes to string\nbase64_string_output = response.content.decode()\n\u200b\n# metadata has been removed, ensure base64 strings are different\nassert base64_string_input != base64_string_output\n\u200b\n# decode base64 string to bytes\nsanitised_file_bytes = base64.b64decode(base64_string_output)\n\u200b\n# write file locally\nwith open("data/doc/embedded_images_12kb_gwsanitised.docx", "wb") as f:\n')),Object(a.b)("h2",{id:"apirebuildfile"},"api/rebuild/file"),Object(a.b)("p",null,"In this example, the contents of the raw file are uploaded in a body with a content type of 'multipart/form-data'. The content management flags are serialised and sent as part of the form."),Object(a.b)("p",null,"The rebuilt file contents are returned to the client and written to disk."),Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre"},'import json\nimport os\nimport requests\n\u200b\nurl = "https://<host>:<port>/api/rebuild/file"\n\u200b\n""" rebuild all files in the "data" directory, writing to a new "data_gwsanitised" directory with the same folder structure.\ndisallow (2) excel files that contain macros and don\'t write them to the new directory.\nallow (0) internal and external hyperlinks found in word documents, but sanitise other content\nsanitise (1, default) and write all other files. """\ndirectory = "data"\nfor root, dirs, files in os.walk(directory):\n    for file_ in files:\n        # create input and out file file paths\n        input_file = os.path.join(root, file_)\n        output_file = os.path.join(f"{directory}_gwsanitised", os.path.relpath(input_file, directory))\n        with open(input_file, "rb") as f:\n            # send post request\n            response = requests.post(\n                url=url,\n                files=[("file", f)],\n                headers={                    \n                    "accept": "application/octet-stream"\n                },\n                data={\n                    "contentManagementFlagJson": json.dumps({\n                        "ExcelContentManagement": {\n                            "Macros": 2,\n                        },\n                        "WordContentManagement": {\n                            "InternalHyperlinks": 0,\n                            "ExternalHyperlinks": 0,\n                            "EmbeddedFiles": 1,\n                            "EmbeddedImages": 1,\n                        }\n                    })\n                }\n            )\n        if response.status_code == 200 and response.content:\n            # glasswall successfully sanitised this file, write it to the new directory\n            os.makedirs(os.path.dirname(output_file), exist_ok=True)\n            with open(output_file, "wb") as f:\n                f.write(response.content)\n')),Object(a.b)("h2",{id:"apirebuildzipfile"},"api/rebuild/zipfile"),Object(a.b)("p",null,"In this example, the contents of the zip file are uploaded in a body with a content type of 'application/zip'."),Object(a.b)("p",null,"The rebuilt file contents are returned to the client and written to disk."),Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre"},'import json\nimport os\nimport requests\n\u200b\nurl = "https://<host>:<port>/api/rebuild/zipfile"\n\u200b\n""" rebuild all files in the "data" directory, writing to a new "data_gwsanitised" directory with the same folder structure.\ndisallow (2) excel files that contain macros and don\'t write them to the new directory.\nallow (0) internal and external hyperlinks found in word documents, but sanitise other content\nsanitise (1, default) and write all other files. """\ndirectory = "data"\nfor root, dirs, files in os.walk(directory):\n    for file_ in files:\n        # create input and out file file paths\n        input_file = os.path.join(root, file_)\n        output_file = os.path.join(f"{directory}_gwsanitised", os.path.relpath(input_file, directory))\n        with open(input_file, "rb") as f:\n            # send post request\n            response = requests.post(\n                url=url,\n                files=[("file", f)],\n                headers={     \n                    "content-type":"application/zip",               \n                    "accept": "application/octet-stream"\n                }\n            )\n        if response.status_code == 200 and response.content:\n            # glasswall successfully sanitised this file, write it to the new directory\n            os.makedirs(os.path.dirname(output_file), exist_ok=True)\n            with open(output_file, "wb") as f:\n                f.write(response.content)\n'))),Object(a.b)(h,{value:"php",mdxType:"TabItem"},Object(a.b)("h1",{id:"php"},"PHP"),Object(a.b)("p",null,"The following code snippets are examples of calling the GW Cloud SDK using php. The requests library is used to execute calls to the API."),Object(a.b)("h2",{id:"apirebuildbase64-using-php"},"api/rebuild/base64 using php"),Object(a.b)("p",null,"\u200bIn this example, files are loaded from the OS and a request with the content type of 'application/json' is formed. The request is then sent to the API using the POST method."),Object(a.b)("p",null,"The rebuilt file is returned as Base64, decoded by the client and written to disk."),Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre"},'<?php\n$jwt_token = "YOUR_JWT_TOKEN";\nurl = "https://<host>:<port>/api/rebuild/base64"\n// local file\n$Input_File = \'YOUR/INPUT/FILE.docx\';\n$output_file_path = "YOUR/OUTPUT/FILE.docx";\n// convert base64 encoded bytes to string\n$base64 = base64_encode(file_get_contents($Input_File));\n$data = [\n    \'Base64\' => $base64,\n    \'ContentManagementFlags\' => [\n        \'WordContentManagement\' => [\n            \'ReviewComments\' => \'0\'\n        ],\n    ]\n];\n$json_data = json_encode($data);\n// create  context \n$context = stream_context_create([\n    \'http\' => [\n        \'method\' => \'POST\',\n        \'header\' => "Authorization: " . $jwt_token . "\\r\\n" .\n            "Content-type: application/json\\r\\n" .\n            "Accept: application/json\\r\\n" .\n            "Connection: close\\r\\n" .\n            "Content-length: " . strlen($json_data) . "\\r\\n",\n        \'content\' => $json_data\n    ],\n\n]);\n//Send a file to Glasswall\'s GW Cloud SDK  endpoint, returns base64 encoded bytes\n$response = file_get_contents($url, false, $context);\nif ($response === false) {\n    exit("Unable to get data at $url");\n}\n//decode base64 string to bytes\n$base64_string_output = base64_decode($response);\n//save file to local\nif (file_put_contents($output_file_path, $base64_string_output)) {\n    echo "File downloaded successfully";\n} else {\n    echo "File downloading failed.";\n}\n')))),Object(a.b)("h1",{id:"js"},"JS"),Object(a.b)("h2",{id:"process-file"},"Process File"),Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre",className:"language-const",metastring:"fs = require('fs');",fs:!0,"":"","require('fs');":!0},"const request = require('request');\n\u200b\nconst apiUrl = 'https://<host>:<port>/api/rebuild/file';\nconst inputFilePath = './data/gw.pdf';\nconst cleanFilePath = './data/clean.pdf';\n\u200b\nconst processFile = async () => {\n    return new Promise(function (resolve, reject) {\n        const options = {\n            method: \"POST\",\n            url: apiUrl,\n            headers: {\n                \"Content-Type\": \"multipart/form-data\"\n            },\n            formData: {\n                \"file\": fs.createReadStream(inputFilePath)\n            },\n            encoding: null\n        };\n\u200b\n        request(options, function (err, res, response) {\n            if (!err && res.statusCode == 200) {\n                fs.writeFileSync(cleanFilePath, response);\n                resolve(true);\n            } else {\n                reject(err);\n            }\n        });\n    });\n}\n\u200b\nmodule.exports = { processFile };\n")),Object(a.b)("h2",{id:"process-zip"},"Process Zip"),Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre"},"const fs = require('fs');\nconst request = require('request');\n\u200b\nconst apiUrl = 'https://<host>:<port>/api/rebuild/zipfile';\nconst inputFilePath = './data/gw.zip';\nconst cleanFilePath = './data/clean.zip';\n\u200b\nconst processZip = async () => {\n    return new Promise(function (resolve, reject) {\n        const options = {\n            method: \"POST\",\n            url: apiUrl,\n            headers: {\n                \"Content-Type\": \"multipart/form-data\"\n            },\n            formData: {\n                \"file\": fs.createReadStream(inputFilePath)\n            },\n            encoding: null\n        };\n\u200b\n        request(options, function (err, res, response) {\n            if (!err && res.statusCode == 200) {\n                fs.writeFileSync(cleanFilePath, response);\n                resolve(true);\n            } else {\n                reject(err);\n            }\n        });\n    });\n}\n\u200b\nmodule.exports = { processZip };\n")),Object(a.b)("h2",{id:"process-base64"},"Process Base64"),Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre"},"const fs = require('fs');\nconst request = require('request');\n\u200b\nconst apiUrl = 'https://<host>:<port>/api/rebuild/base64';\nconst inputFilePath = './data/gw.pdf';\nconst cleanFilePath = './data/clean.pdf';\n\u200b\nconst processBase64 = async () => {\n    return new Promise(function (resolve, reject) {\n        const contents = fs.readFileSync(inputFilePath, { encoding: 'base64' });\n        const options = {\n            method: \"POST\",\n            url: apiUrl,\n            headers: {\n                \"Content-Type\": \"application/json\"\n            },\n            body: {\n                base64: contents\n            },\n            json: true\n        };\n\u200b\n        request(options, function (err, res, response) {\n            if (!err && res.statusCode == 200) {\n                fs.writeFileSync(cleanFilePath, response, { encoding: 'base64' });\n                resolve(true);\n            } else {\n                reject(err);\n            }\n        });\n    });\n}\n\u200b\nmodule.exports = { processBase64 };\n")))}j.isMDXComponent=!0},99:function(e,n,t){"use strict";t.d(n,"a",(function(){return u})),t.d(n,"b",(function(){return b}));var r=t(0),o=t.n(r);function i(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function s(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function a(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?s(Object(t),!0).forEach((function(n){i(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):s(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,r,o=function(e,n){if(null==e)return{};var t,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var c=o.a.createContext({}),p=function(e){var n=o.a.useContext(c),t=n;return e&&(t="function"==typeof e?e(n):a(a({},n),e)),t},u=function(e){var n=p(e.components);return o.a.createElement(c.Provider,{value:n},e.children)},d={inlineCode:"code",wrapper:function(e){var n=e.children;return o.a.createElement(o.a.Fragment,{},n)}},f=o.a.forwardRef((function(e,n){var t=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),u=p(t),f=r,b=u["".concat(s,".").concat(f)]||u[f]||d[f]||i;return t?o.a.createElement(b,a(a({ref:n},c),{},{components:t})):o.a.createElement(b,a({ref:n},c))}));function b(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var i=t.length,s=new Array(i);s[0]=f;var a={};for(var l in n)hasOwnProperty.call(n,l)&&(a[l]=n[l]);a.originalType=e,a.mdxType="string"==typeof e?e:r,s[1]=a;for(var c=2;c<i;c++)s[c]=t[c];return o.a.createElement.apply(null,s)}return o.a.createElement.apply(null,t)}f.displayName="MDXCreateElement"}}]);