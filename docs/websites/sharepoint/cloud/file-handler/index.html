<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.66">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-165717322-1"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-165717322-1",{})</script>
<link rel="search" type="application/opensearchdescription+xml" title="K8 Proxy Documentation" href="/k8-proxy-documentation/opensearch.xml"><title data-react-helmet="true">Sharepoint Cloud File Handler - .NET Framework | K8 Proxy Documentation</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Sharepoint Cloud File Handler - .NET Framework | K8 Proxy Documentation"><meta data-react-helmet="true" name="description" content="Introduction"><meta data-react-helmet="true" property="og:description" content="Introduction"><meta data-react-helmet="true" property="og:url" content="https://k8-proxy.github.io/k8-proxy-documentation/docs/websites/sharepoint/cloud/file-handler"><link data-react-helmet="true" rel="shortcut icon" href="/k8-proxy-documentation/img/favicon.ico"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link data-react-helmet="true" rel="canonical" href="https://k8-proxy.github.io/k8-proxy-documentation/docs/websites/sharepoint/cloud/file-handler"><link rel="stylesheet" href="/k8-proxy-documentation/styles.a5f35196.css">
<link rel="preload" href="/k8-proxy-documentation/styles.9360dbee.js" as="script">
<link rel="preload" href="/k8-proxy-documentation/runtime~main.4b2187ca.js" as="script">
<link rel="preload" href="/k8-proxy-documentation/main.b9de4a6b.js" as="script">
<link rel="preload" href="/k8-proxy-documentation/1.ef5945a4.js" as="script">
<link rel="preload" href="/k8-proxy-documentation/2.8f19f519.js" as="script">
<link rel="preload" href="/k8-proxy-documentation/64.9a2131e3.js" as="script">
<link rel="preload" href="/k8-proxy-documentation/67.2183575b.js" as="script">
<link rel="preload" href="/k8-proxy-documentation/935f2afb.9707453b.js" as="script">
<link rel="preload" href="/k8-proxy-documentation/17896441.7eb99b61.js" as="script">
<link rel="preload" href="/k8-proxy-documentation/cc1111b1.34de2cf5.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/k8-proxy-documentation/"><img class="navbar__logo" src="/k8-proxy-documentation/img/glasswall_logo_blue.png" alt="Glasswall Logo"><strong class="navbar__title">K8 Proxy Documentation</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/k8-proxy-documentation/docs/dashboards/websites/production">Documentation</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/k8-proxy" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2aTZ"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_BsTx">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_BsTx">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span><span class="DocSearch-Button-Key">âŒ˜</span><span class="DocSearch-Button-Key">K</span></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/k8-proxy-documentation/"><img class="navbar__logo" src="/k8-proxy-documentation/img/glasswall_logo_blue.png" alt="Glasswall Logo"><strong class="navbar__title">K8 Proxy Documentation</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/k8-proxy-documentation/docs/dashboards/websites/production">Documentation</a></li><li class="menu__list-item"><a href="https://github.com/k8-proxy" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_2gpo"><div class="docSidebarContainer_3_JD" role="complementary"><div class="sidebar_2urC"><div class="menu menu--responsive menu_5FrY"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_Dm3K" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Dashboards</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Client Welcome</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/dashboards/client-welcome/index">index</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Websites</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/dashboards/websites/deployment-notes">Deployment notes</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/dashboards/websites/development">Development</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/dashboards/websites/flavors">Flavors</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/dashboards/websites/notassigned">Not assigned sites</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/dashboards/websites/production">Production</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Flavors</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Flavor OVA</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/flavors/flavor-a/automated-setup">Automated Setup</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/flavors/flavor-a/faq">FAQ</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/flavors/flavor-a/manual-setup-aws">Manual Setup (AWS)</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/flavors/flavor-a/overview">Overview</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">release-notes</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">0_x</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/flavors/flavor-a/release-notes/0_x/0_1">0.1 Release Notes</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/flavors/flavor-a/release-notes/history">Release Notes History</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/flavors/flavor-a/technical-architecture">Terchnical Architecture</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/flavors/flavor-a/testing">Testing</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">flavor-e</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/flavors/flavor-e/manual-setup-aws">Manual Setup (AWS)</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">flavor-ova</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/flavors/flavor-ova/automated-setup">Automated Setup</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/flavors/flavor-ova/faq">FAQ</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/flavors/flavor-ova/manual-setup-aws">Manual Setup (AWS)</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/flavors/flavor-ova/manual-setup-azure">Manual Setup (Azure)</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/flavors/flavor-ova/overview">Overview</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">release-notes</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">0_x</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/flavors/flavor-ova/release-notes/0_x/0_1">0.1 Release Notes</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/flavors/flavor-ova/release-notes/history">Release Notes History</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/flavors/flavor-ova/technical-architecture">Terchnical Architecture</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/flavors/flavor-ova/testing">Testing</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">ESXI</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">OVAs</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/esxi/OVAs/overview">OVAs documentation</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Websites</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">OWASP</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/esxi/Websites/OWASP/overview">OWASP</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">glasswall-solutions</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/esxi/Websites/glasswall-solutions/overview">Glasswall Solutions</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Welcome</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/esxi/Welcome/welcome">ESXi deployment</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Architecture</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/esxi/architecture/overview">Technical Architecture</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Knowledge Base</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/kb/auto-sidebar">Auto Sidebar Guidelines</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/kb/mdx">Powered by MDX</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/kb/style-guide">Style Guide</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/kb/website-checklist">Website Implementation and documentation checklist</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Websites</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">gwfiledrop</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/websites/gwfiledrop/overview">Overview</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">adarma</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/websites/adarma/overview">Overview</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">bsigroup</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/websites/bsigroup/overview">Overview</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">emma-dataport</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/websites/emma-dataport/overview">Overview</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">fortinet</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/websites/fortinet/overview">Overview</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">gov.uk</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/websites/gov.uk/overview">Overview</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">gwengineering</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/websites/gwengineering/overview">Overview</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">atlassian</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/websites/atlassian/overview">Overview</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">gwwebsite</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/websites/gwwebsite/overview">Overview</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">mastercard</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/websites/mastercard/overview">Overview</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">microsoft</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/websites/microsoft/overview">Overview</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">miniio</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/websites/miniio/overview">Overview</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">owasp</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/websites/owasp/overview">Overview</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!" tabindex="0">sharepoint</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!" tabindex="0">cloud</a><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/k8-proxy-documentation/docs/websites/sharepoint/cloud/file-handler">File Handler .NET Framework</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">self-hosted</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/websites/sharepoint/self-hosted/export-ova-aws">Export OVA from AWS</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/websites/sharepoint/self-hosted/overview">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/websites/sharepoint/self-hosted/sp-ova-aws">Sharepoint OVA in AWS</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/websites/sharepoint/self-hosted/sp-plugin">Plugin</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/websites/sharepoint/self-hosted/sp-vhd-to-ova">Sharepoint VHD to OVA</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/websites/sharepoint/self-hosted/sp-vm-manual-install">Sharepoint VM - Manual Install</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">web</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/websites/sharepoint/web/overview">Overview</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">ukzones</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/websites/ukzones/overview">Overview</a></li></ul></li></ul></li></ul></div></div></div><main class="docMainContainer_3EyW"><div class="container padding-vert--lg docItemWrapper_1EkI"><div class="row"><div class="col docItemCol_2ASc"><div class="docItemContainer_3QWW"><article><header><h1 class="docTitle_1Lrw">Sharepoint Cloud File Handler - .NET Framework</h1></header><div class="markdown"><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="introduction"></a>Introduction<a aria-hidden="true" tabindex="-1" class="hash-link" href="#introduction" title="Direct link to heading">#</a></h1><p>Glasswall File Handler - .NET Framework Version</p><p>This project provides a sample implementation of a file handler 2.0 for Microsoft Office 365.
This sample illustrates a custom action, with the <strong>Glasswall Download</strong> action added to all files. The file handler allows downloading a file by rebuilding the file using Glasswall Rebuild Api.</p><p>[Repository] (<a href="https://github.com/k8-proxy/gp-sharepoint-plugins/tree/main/O365/DotNetFramework" target="_blank" rel="noopener noreferrer">https://github.com/k8-proxy/gp-sharepoint-plugins/tree/main/O365/DotNetFramework</a>)</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="getting-started"></a>Getting Started<a aria-hidden="true" tabindex="-1" class="hash-link" href="#getting-started" title="Direct link to heading">#</a></h2><p>To get started with the sample, you need to complete the following actions:</p><ol><li>Register a new application with Azure Active Directory, generate an app password, and provide a redirect URI for the application.</li><li>Register the file handler extensions as an add-in for your application in Azure Active Directory.</li><li>Run the sample project and sign-in with your Office 365 account and accept the consent prompt so the file handler is registered for your account.</li><li>Navigate to OneDrive for Business or a SharePoint document library and allow file handlers to load.</li><li>Select any file. Then Click on the custom action button to download the selected file by rebuilding it using Glasswall rebuild api.</li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="register-a-new-application"></a>Register a new application<a aria-hidden="true" tabindex="-1" class="hash-link" href="#register-a-new-application" title="Direct link to heading">#</a></h3><p>To register a new application with Azure Active Directory, log into the <a href="https://portal.azure.com" target="_blank" rel="noopener noreferrer">Azure Portal</a>.</p><p>After logging into the Azure Portal, the following steps will allow you to register your file handler application:</p><ol><li>Navigate to the <strong>Azure Active Directory</strong> module.</li><li>Select <strong>App registrations</strong> and click <strong>New application registration</strong>.<ol><li>Type the name of your file handler application.</li><li>Ensure <strong>Application Type</strong> is set to <strong>Web app / API</strong></li><li>Enter a sign-on URL for your application, for this sample use <code>https://localhost:44362</code>.</li><li>Click <strong>Create</strong> to create the app.</li></ol></li><li>After the app has been created successfully, select the app from the list of applications. It should be at the bottom of the list.</li><li>Copy the <strong>Application ID</strong> for the app you registered and paste it into the Web.config file on the line: <code>&lt;add key=&quot;ida:ClientId&quot; value=&quot;application id here&quot; /&gt;</code></li><li>Make a note of the <strong>Object ID</strong> for this application, since you will need this later to register the file handler manifest.</li><li>Configure the application settings for this sample:<ol><li>Select <strong>Reply URLs</strong> and ensure that <code>https://localhost:44362</code> is listed.</li><li>Select <strong>Required Permissions</strong> and then <strong>Add</strong>.</li><li>Select <strong>Select an API</strong> and then choose <strong>Microsoft Graph</strong> and click <strong>Select</strong>.</li><li>Find the permission <strong>Have full access to all files user can access</strong> and check the box next to it, then click <strong>Select</strong>, and then <strong>Done</strong>.</li><li>Select <strong>Keys</strong> and generate a new application key by entering a description for the key, selecting a duration, and then click <strong>Save</strong>. Copy the value of the displayed key since it will only be displayed once.<ul><li>Paste the value of the key you generated into the Web.config file in this project, inside the value for the line: <code>&lt;add key=&quot;ida:ClientSecret&quot; value=&quot;put application key here&quot; /&gt;</code></li></ul></li></ol></li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="register-the-file-handler-manifest"></a>Register the file handler manifest<a aria-hidden="true" tabindex="-1" class="hash-link" href="#register-the-file-handler-manifest" title="Direct link to heading">#</a></h3><p>After registering your app with Azure Active Directory, you can upload the file handler manifest information into the application.</p><p>For detailed instructions on how to upload the file handler manifest, see <a href="https://docs.microsoft.com/en-us/onedrive/developer/file-handlers/register-manually" target="_blank" rel="noopener noreferrer">Registering file handlers</a>.</p><p>The file handler manifest for this sample  is available in the <code>addin-schema.json</code> file in this project.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="register-an-azure-storage-instance"></a>Register an Azure Storage instance<a aria-hidden="true" tabindex="-1" class="hash-link" href="#register-an-azure-storage-instance" title="Direct link to heading">#</a></h3><p>The sample uses an Azure Storage table to cache user and token information.
To successfully run the sample, you must provide an Azure Storage connection string in Web.config:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-xml codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">add</span><span class="token tag" style="color:rgb(255, 85, 114)"> </span><span class="token tag attr-name" style="color:rgb(255, 203, 107)">key</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 85, 114)">StorageConnectionString</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(255, 85, 114)"> </span><span class="token tag attr-name" style="color:rgb(255, 203, 107)">value</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 85, 114)">[AzureStorageConnectionString]</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(255, 85, 114)"> </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">/&gt;</span></div></div></div></div></div><p>To create a new storage instance and copy the connection string:</p><ol><li>Open the <a href="https://portal.azure.com" target="_blank" rel="noopener noreferrer">Azure Portal</a> in your browser. You must have an Azure Subscription or trial subscription.</li><li>Select <strong>Storage Accounts</strong> and then click <strong>Add</strong>.</li><li>Name the storage account, leaving the defaults as they are. You will also need to create a new resource group and provide a name.</li><li>Click <strong>Create</strong> to provision the storage account.</li><li>After the storage account has finished provisioning, select it from the list of storage accounts. Click on the <strong>Access Keys</strong> tab, and copy the connection string for <strong>key1</strong>.</li><li>Paste this connection string where <code>[AzureStorageConnectionString]</code> appears in Web.config.</li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="glasswall-rebuild-api-key"></a>Glasswall Rebuild Api Key<a aria-hidden="true" tabindex="-1" class="hash-link" href="#glasswall-rebuild-api-key" title="Direct link to heading">#</a></h3><p>This sample connects to one of the Glasswall Rebuild Api. You will need an Api Key to rebuild the files. Reach out to Glasswall Engineering to know how to get the Api Key. To successfully run the sample, you must provide an Api Key in Web.config:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-xml codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">add</span><span class="token tag" style="color:rgb(255, 85, 114)"> </span><span class="token tag attr-name" style="color:rgb(255, 203, 107)">key</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 85, 114)">GwRebuildApiKey</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(255, 85, 114)"> </span><span class="token tag attr-name" style="color:rgb(255, 203, 107)">value</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 85, 114)">[ApiKey]</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">/&gt;</span></div></div></div></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="run-the-project-and-sign-in"></a>Run the project and sign-in<a aria-hidden="true" tabindex="-1" class="hash-link" href="#run-the-project-and-sign-in" title="Direct link to heading">#</a></h3><p>Once your project is registered and configured, you&#x27;re ready to run it. Press F5 to launch the project in the debugger.
The file handler project will load in your default browser and be ready for you to sign in.
Sign in to the file handler project, and authorize the application to have access to the data in your OneDrive.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="navigate-to-onedrive-and-use-the-markdown-file-handler"></a>Navigate to OneDrive and use the Markdown file handler<a aria-hidden="true" tabindex="-1" class="hash-link" href="#navigate-to-onedrive-and-use-the-markdown-file-handler" title="Direct link to heading">#</a></h3><p>Once you have authorized the file handler to have access, the file handler will be available in OneDrive and SharePoint.
After signing in to the app, click the &quot;Try it in OneDrive&quot; button to launch your OneDrive.
Due to service caches, it may take a few minutes before your file handler shows up in OneDrive.
You may need to close your browser and open it again before the file handler will be activated.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="next-steps"></a>Next Steps<a aria-hidden="true" tabindex="-1" class="hash-link" href="#next-steps" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="download-file-with-glasswall-rebuild"></a>Download file with Glasswall Rebuild<a aria-hidden="true" tabindex="-1" class="hash-link" href="#download-file-with-glasswall-rebuild" title="Direct link to heading">#</a></h3><p>To use the custom action provided by the file handler, perform the following actions:</p><ul><li>Navigate to OneDrive/Sharepoint online.</li><li>Select a file (click the check) and then in the toolbar, click <code>...</code> and then <strong>Glasswall Download</strong>.</li><li>This will launch the file handler&#x27;s custom action handler</li><li>The file handler code will:<ul><li>Read the selected file&#x27;s content from OneDrive/Sharepoint</li><li>Rebuild it with Glasswall Rebuild Api </li><li>Download the file onto your machine.</li></ul></li></ul></div></article><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/k8-proxy-documentation/docs/websites/owasp/overview"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« owasp Overview</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/k8-proxy-documentation/docs/websites/sharepoint/self-hosted/export-ova-aws"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Export OVA from AWS Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_3SO_"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#getting-started" class="table-of-contents__link">Getting Started</a><ul><li><a href="#register-a-new-application" class="table-of-contents__link">Register a new application</a></li><li><a href="#register-the-file-handler-manifest" class="table-of-contents__link">Register the file handler manifest</a></li><li><a href="#register-an-azure-storage-instance" class="table-of-contents__link">Register an Azure Storage instance</a></li><li><a href="#glasswall-rebuild-api-key" class="table-of-contents__link">Glasswall Rebuild Api Key</a></li><li><a href="#run-the-project-and-sign-in" class="table-of-contents__link">Run the project and sign-in</a></li><li><a href="#navigate-to-onedrive-and-use-the-markdown-file-handler" class="table-of-contents__link">Navigate to OneDrive and use the Markdown file handler</a></li></ul></li><li><a href="#next-steps" class="table-of-contents__link">Next Steps</a><ul><li><a href="#download-file-with-glasswall-rebuild" class="table-of-contents__link">Download file with Glasswall Rebuild</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/k8-proxy-documentation/docs/dashboards/websites/production">Getting Started</a></li></ul></div></div><div class="text--center"><div>Copyright Â© 2020 Glasswall Solutions Ltd. Built with Docusaurus.</div></div></div></footer></div>
<script src="/k8-proxy-documentation/styles.9360dbee.js"></script>
<script src="/k8-proxy-documentation/runtime~main.4b2187ca.js"></script>
<script src="/k8-proxy-documentation/main.b9de4a6b.js"></script>
<script src="/k8-proxy-documentation/1.ef5945a4.js"></script>
<script src="/k8-proxy-documentation/2.8f19f519.js"></script>
<script src="/k8-proxy-documentation/64.9a2131e3.js"></script>
<script src="/k8-proxy-documentation/67.2183575b.js"></script>
<script src="/k8-proxy-documentation/935f2afb.9707453b.js"></script>
<script src="/k8-proxy-documentation/17896441.7eb99b61.js"></script>
<script src="/k8-proxy-documentation/cc1111b1.34de2cf5.js"></script>
</body>
</html>