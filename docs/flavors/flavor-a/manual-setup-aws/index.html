<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.66">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-165717322-1"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-165717322-1",{})</script>
<link rel="search" type="application/opensearchdescription+xml" title="K8 Proxy Documentation" href="/k8-proxy-documentation/opensearch.xml"><title data-react-helmet="true">Flavor A Manual Setup (AWS) | K8 Proxy Documentation</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Flavor A Manual Setup (AWS) | K8 Proxy Documentation"><meta data-react-helmet="true" name="description" content="Requirements"><meta data-react-helmet="true" property="og:description" content="Requirements"><meta data-react-helmet="true" property="og:url" content="https://k8-proxy.github.io/k8-proxy-documentation/docs/flavors/flavor-a/manual-setup-aws"><link data-react-helmet="true" rel="shortcut icon" href="/k8-proxy-documentation/img/favicon.ico"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link data-react-helmet="true" rel="canonical" href="https://k8-proxy.github.io/k8-proxy-documentation/docs/flavors/flavor-a/manual-setup-aws"><link rel="stylesheet" href="/k8-proxy-documentation/styles.a5f35196.css">
<link rel="preload" href="/k8-proxy-documentation/styles.0550aa6a.js" as="script">
<link rel="preload" href="/k8-proxy-documentation/runtime~main.de42f7e0.js" as="script">
<link rel="preload" href="/k8-proxy-documentation/main.2a6c69ef.js" as="script">
<link rel="preload" href="/k8-proxy-documentation/1.d6718f81.js" as="script">
<link rel="preload" href="/k8-proxy-documentation/2.4f823a40.js" as="script">
<link rel="preload" href="/k8-proxy-documentation/51.840a95c1.js" as="script">
<link rel="preload" href="/k8-proxy-documentation/54.26f0564e.js" as="script">
<link rel="preload" href="/k8-proxy-documentation/935f2afb.fba4e263.js" as="script">
<link rel="preload" href="/k8-proxy-documentation/17896441.1837de2b.js" as="script">
<link rel="preload" href="/k8-proxy-documentation/5573db2a.fc90c53e.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/k8-proxy-documentation/"><img class="navbar__logo" src="/k8-proxy-documentation/img/glasswall_logo_blue.png" alt="Glasswall Logo"><strong class="navbar__title">K8 Proxy Documentation</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/k8-proxy-documentation/docs/dashboards/websites/production">Documentation</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/k8-proxy" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2aTZ"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_BsTx">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_BsTx">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span><span class="DocSearch-Button-Key">âŒ˜</span><span class="DocSearch-Button-Key">K</span></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/k8-proxy-documentation/"><img class="navbar__logo" src="/k8-proxy-documentation/img/glasswall_logo_blue.png" alt="Glasswall Logo"><strong class="navbar__title">K8 Proxy Documentation</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/k8-proxy-documentation/docs/dashboards/websites/production">Documentation</a></li><li class="menu__list-item"><a href="https://github.com/k8-proxy" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_2gpo"><div class="docSidebarContainer_3_JD" role="complementary"><div class="sidebar_2urC"><div class="menu menu--responsive menu_5FrY"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_Dm3K" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Dashboards</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Websites</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/dashboards/websites/production">Production</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/dashboards/websites/development">Development</a></li></ul></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Flavors</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!" tabindex="0">Flavor A</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/k8-proxy-documentation/docs/flavors/flavor-a/overview">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/k8-proxy-documentation/docs/flavors/flavor-a/technical-architecture">Terchnical Architecture</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/k8-proxy-documentation/docs/flavors/flavor-a/faq">FAQ</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/k8-proxy-documentation/docs/flavors/flavor-a/manual-setup-aws">Manual Setup (AWS)</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/k8-proxy-documentation/docs/flavors/flavor-a/automated-setup">Automated Setup</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/k8-proxy-documentation/docs/flavors/flavor-a/testing">Testing</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Release Notes</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/flavors/flavor-a/release-notes/history">Release Notes History</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">0.x</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/flavors/flavor-a/release-notes/0_x/0_1">0.1 Release Notes</a></li></ul></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Flavor OVA</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/flavors/flavor-ova/overview">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/flavors/flavor-ova/technical-architecture">Terchnical Architecture</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/flavors/flavor-ova/faq">FAQ</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/flavors/flavor-ova/manual-setup-aws">Manual Setup (AWS)</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/flavors/flavor-ova/manual-setup-azure">Manual Setup (Azure)</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/flavors/flavor-ova/automated-setup">Automated Setup</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/flavors/flavor-ova/testing">Testing</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Release Notes</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/flavors/flavor-ova/release-notes/history">Release Notes History</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">0.x</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/flavors/flavor-ova/release-notes/0_x/0_1">0.1 Release Notes</a></li></ul></li></ul></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Websites</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">SharePoint</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">cloud</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/websites/sharepoint/cloud/overview">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/websites/sharepoint/cloud/file-handler">File Handler</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">self-hosted</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/websites/sharepoint/self-hosted/overview">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/websites/sharepoint/self-hosted/manual-install">Manual Install</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/websites/sharepoint/self-hosted/http-module">Http Module</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">owasp</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/websites/owasp/overview">Overview</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">github</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/websites/github/overview">Overview</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">microsoft</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/websites/microsoft/overview">Overview</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">fortinet</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/websites/fortinet/overview">Overview</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">a10networks</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/websites/a10networks/overview">Overview</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">bsigroup</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/websites/bsigroup/overview">Overview</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">gwengineering</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/websites/gwengineering/overview">Overview</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">gwwebsite</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/websites/gwwebsite/overview">Overview</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">msrb</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/websites/msrb/overview">Overview</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">ukzones</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/websites/ukzones/overview">Overview</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">KB</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/kb/style-guide">Style Guide</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/kb/website-checklist">Website Implementation and documentation checklist</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">gov.uk</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/websites/gov.uk/overview">Overview</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">gwfiledrop</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/websites/gwfiledrop/overview">Overview</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">atlassian</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/websites/atlassian/overview">Overview</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">owasp</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/websites/owasp/overview">Overview</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">github</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/websites/github/overview">Overview</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">microsoft</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/websites/microsoft/overview">Overview</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">fortinet</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/websites/fortinet/overview">Overview</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">a10networks</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/websites/a10networks/overview">Overview</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">bsigroup</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/websites/bsigroup/overview">Overview</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">gwengineering</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/websites/gwengineering/overview">Overview</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">gwwebsite</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/websites/gwwebsite/overview">Overview</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">msrb</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/websites/msrb/overview">Overview</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">ukzones</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/websites/ukzones/overview">Overview</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">KB</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/kb/style-guide">Style Guide</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/k8-proxy-documentation/docs/kb/website-checklist">Website Implementation and documentation checklist</a></li></ul></li></ul></div></div></div><main class="docMainContainer_3EyW"><div class="container padding-vert--lg docItemWrapper_1EkI"><div class="row"><div class="col docItemCol_2ASc"><div class="docItemContainer_3QWW"><article><header><h1 class="docTitle_1Lrw">Flavor A Manual Setup (AWS)</h1></header><div class="markdown"><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="requirements"></a>Requirements<a aria-hidden="true" tabindex="-1" class="hash-link" href="#requirements" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="client-machine-tools"></a>Client Machine tools<a aria-hidden="true" tabindex="-1" class="hash-link" href="#client-machine-tools" title="Direct link to heading">#</a></h3><ul><li><strong>kubectl</strong> <a href="https://kubernetes.io/docs/tasks/tools/install-kubectl/" target="_blank" rel="noopener noreferrer">https://kubernetes.io/docs/tasks/tools/install-kubectl/</a></li><li><strong>aws cli</strong>  <a href="https://docs.aws.amazon.com/cli/latest/userguide/install-cliv2.html" target="_blank" rel="noopener noreferrer">https://docs.aws.amazon.com/cli/latest/userguide/install-cliv2.html</a></li><li><strong>docker</strong>  <a href="https://docs.docker.com/engine/" target="_blank" rel="noopener noreferrer">https://docs.docker.com/engine/</a></li><li><strong>helm</strong> <a href="https://helm.sh/docs/intro/install/" target="_blank" rel="noopener noreferrer">https://helm.sh/docs/intro/install/</a></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="aws-requirements"></a>AWS requirements<a aria-hidden="true" tabindex="-1" class="hash-link" href="#aws-requirements" title="Direct link to heading">#</a></h3><ul><li>An IAM user with <strong>SystemAdministrator</strong> policy attached. If yuo don&#x27;t have permission to change Policies or create ECR repository contact the administrator.</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="setting-up-aws-resource-group"></a>Setting up AWS Resource Group<a aria-hidden="true" tabindex="-1" class="hash-link" href="#setting-up-aws-resource-group" title="Direct link to heading">#</a></h2><ol><li>Open the Resource Group console at <a href="https://console.aws.amazon.com/resource-groups" target="_blank" rel="noopener noreferrer">https://console.aws.amazon.com/resource-groups</a></li><li>In <strong>Create Resource Group</strong>, select Tag Based.</li><li>Add two tags with:
<img alt="step3" src="/k8-proxy-documentation/assets/images/step3-c97df4a8b5efd70f058df5f7304067ce.png"><ol><li>Key rg-gw-dev and name rancher</li><li>Key rg-gw-dev and name k8s-node</li><li>Key rg-gw-dev and name rancher-user</li><li>Key rg-gw-dev and name ecr-user</li></ol></li><li>These will be used later when creating EC2 instances for rancher and k8s
<img alt="step4" src="/k8-proxy-documentation/assets/images/step4-f2467b0f56b8002ac52b81049e97b7aa.png"></li><li>Add group name then choose <strong>Create Group</strong></li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="setting-up-aws-ec2-instance-for-rancher-for-flavour-a"></a>Setting up AWS EC2 instance for Rancher for Flavour A<a aria-hidden="true" tabindex="-1" class="hash-link" href="#setting-up-aws-ec2-instance-for-rancher-for-flavour-a" title="Direct link to heading">#</a></h2><ol><li>Open the EC2 console at <a href="https://console.aws.amazon.com/ec2/" target="_blank" rel="noopener noreferrer">https://console.aws.amazon.com/ec2/</a></li><li>Click on instances
<img alt="step2" src="/k8-proxy-documentation/assets/images/step2-13b540ce6e9e69c2204ebbc4d151bf3b.png"></li><li>Launch instances
<img alt="step3" src="/k8-proxy-documentation/assets/images/step3-76b67412484f7b4f5b768190a92525a3.png"></li><li>In <strong>Step 1: Choose an Amazon Machine Image (AMI)</strong>, Select <strong>Ubuntu Server 20.04 LTS (HVM), SSD Volume Type</strong>.
<img alt="step31" src="/k8-proxy-documentation/assets/images/step31-9fb59ee1cda97d8b0bb343bc2b49089c.png"></li><li>In <strong>Step 2: Choose an Instance Type</strong>, For Flavour A, We went with t3a.medium because of the minimum requirement for Rancher  choose <strong>Next: Configure Instance Details</strong>.
<img alt="step32" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAB14AAAAtCAIAAACBPV7VAAAAA3NCSVQICAjb4U/gAAAZS0lEQVR4nO3df0wbZ5oH8O+WNJ7du8PWbmvo7mJYNTjslSbcmqQ0LBfCEQVySLGvkQAlkuGQ+HFVCURClIgUZYtKOUspEDUFJA4spYotZWVX4iBV9hx6FI4k+JakzpWF6NaY/WF7t3d2ur2ON0m5P4zBQEiAEAz29yP+sMfvzLzG7zvvzDMzz3xrZmYGAACr1apSqbCxQrJSIloh9tDww9+U1hdbFG0YNjaiNWP3IVozdh+iNWP32Sq+FRwaDm1ViIiIiIiIiIiIiGhjbAt+o9j5kw1eveNX/7nxKyWiFWIPDT/8TWl9sUXRhmFjI1ozdh+iNWP3IVozdp+t4plQV4CIiIiIiIiIiIiINhpDw0REREREREREREQRh6FhIiIiIiIiIiIioojD0DARERERERERERFRxGFomIiIiIiIiIiIiCjiMDRMREREREREREREFHEYGiYiIiIiIiIiIiKKOAwNExEREREREREREUUchoaJiIiIiIiIiIiIIs621c5w78/i3T/+7uuvvvzmmwfLlXnmmajv/JU0+nsvbHtW8mTVIyIiIiIiIiIiIqL1t7rQ8D3f13/47Z0f/uAHz8Y+v23bsvPev3//3r17v3FMPB+349nt337iShIRERERERERERHRelpFQol7fxb/+Ns7O158URCEqKiomeVFRUUJgrBjx4t/mL5z78++p1d7IiIiIiIiIiIiIlqDVVw17P3i97GxsQD+5Pum7d/vDv6370++bx5aMvfH36782+i/lDzzwgux//PF7773wo/Wp7JERKFjAwAkA5OAF0gNcXWIiIjCgRuwAVmhrgYREYW3ISAOUKx+xj4gCxAWTuTgReFkFVcN+776cvv27TMzM40f/++/3v7q7tf3v1nGv97+qmXAOzMzs337dvGrL59e7WmTsAF9wCgghromFN5C29Laytv1tT0A+t8yGItaQlEF2iCjgCVwMoDoaXAAfaGuA0Uy/3i66G8UAOBeOHHpllAERoE+wAI41qUyV8beeKl4PZZEtEn1Ae6HTVyXHkQUEqMPGyD6AO/TWZ24ZMx6RPexARbAsqTftWXVWS8MrHbVXlEseq5wesK5aPrklbG3OXiFqQjcaK/iquEHD+7780gMTH71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"></li><li>In <strong>Step 3: Choose an Instance Type</strong>, Leave everything to default and choose <strong>Next: Add Storage</strong>.
<img alt="step331" src="/k8-proxy-documentation/assets/images/step331-c49fd332e9743dfd5191415b2b57c58d.png"><img alt="step332" src="/k8-proxy-documentation/assets/images/step332-d3aa50e34f007116e383920ddcea0e67.png"></li><li>In <strong>Step 4: Add Storage</strong>, change size to 30GB then choose <strong>Next: Add Tags</strong><img alt="step34" src="/k8-proxy-documentation/assets/images/step34-12e72d39dd807afa4490c0e2fe4969a5.png"></li><li>In <strong>Step 5: Add Tags</strong>, add a tag with key rg-gw-dev and name rancher i.e the tag we added in our Resource Group. The tag should match the one you created in Resource Group since we are using Resource Group based on tags. Choose <strong>Next: Configure Security Group</strong><img alt="step35" src="/k8-proxy-documentation/assets/images/step35-abc8bb86932fd1525a6c1669faa7c48e.png"></li><li>In <strong>Step 6: Configure Security Group</strong>, select Create a new security group if not previously created. Give the name and description for the security group. Leave everything to default and choose <strong>Next: Review Instance Launch</strong><img alt="step36" src="/k8-proxy-documentation/assets/images/step36-797437775d4e7e0a2e40804a3850b706.png"></li><li>In <strong>Step 7: Review Instance Launch</strong>, review everything and <strong>Click on Launch</strong></li><li>Download the key pair to ssh into the server later. If you donâ€™t download the keypair now you wonâ€™t be able to in the future
<img alt="step37" src="/k8-proxy-documentation/assets/images/step37-1606d5cab7736d58e091866dd6faca02.png"></li><li>Launch instances</li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="associate-elastic-ip-to-rancher-instance"></a>Associate Elastic IP to Rancher Instance<a aria-hidden="true" tabindex="-1" class="hash-link" href="#associate-elastic-ip-to-rancher-instance" title="Direct link to heading">#</a></h2><p>The public ip AWS assings isn&#x27;t persistent and will change everytime you shutdown the instace.So, you&#x27;ll need to set-up an Elastic IP.</p><ol><li>Open the EC2 console at <a href="http://console.aws.amazon.com/ec2" target="_blank" rel="noopener noreferrer">http://console.aws.amazon.com/ec2</a></li><li>Select <strong>Elastic IP</strong> and click on <strong>Allocate Elastic IP address</strong><img alt="step2" src="/k8-proxy-documentation/assets/images/step2-11be7b3ed319ec64f1cc378a0a8ab7aa.png"></li><li>Choose <strong>Allocate</strong><img alt="step3" src="/k8-proxy-documentation/assets/images/step3-344bf373bce74426c765c689ebeae2af.png"></li><li>Select the newly created Elastic IP, choose actions then choose <strong>Associate IP address</strong><img alt="step4" src="/k8-proxy-documentation/assets/images/step4-ace7298db6ed992a6f3cf6a0156324a9.png"></li><li>Select the Rancher instance and select the private ip that has been associated with the rancher instance.Choose <strong>Associate</strong><img alt="step5" src="/k8-proxy-documentation/assets/images/step5-27d969f1d6510fa02666a11bb71d292a.png"></li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="setting-up-route-53-for-rancher-instance"></a>Setting up Route 53 for Rancher Instance<a aria-hidden="true" tabindex="-1" class="hash-link" href="#setting-up-route-53-for-rancher-instance" title="Direct link to heading">#</a></h2><p><strong>The following steps are done using the old console. Switch to the old console before proceeding.</strong></p><ol><li>Open the Route 53 Console <a href="https://console.aws.amazon.com/route53" target="_blank" rel="noopener noreferrer">https://console.aws.amazon.com/route53</a></li><li>Select <strong>Hosted Zone</strong><img alt="step2" src="/k8-proxy-documentation/assets/images/step2-4830d407812bda8498254ca1d1a09c22.png"></li><li>Click on <strong>Create Hosted Zone</strong> and enter your domain name you want to use for the AWS instances</li><li>Copy the NS value and follow the process of your registrar for the domain to change the name servers of your domain to user the four Route 54 name server that you got after step 3.
<img alt="step4" src="/k8-proxy-documentation/assets/images/step4-f870bba8b8e77ba9ad679867977a815f.png"></li><li>Then we need to create an A record for the Rancher instance. Click on <strong>Create Record Set</strong><img alt="step5" src="/k8-proxy-documentation/assets/images/step5-68c6e3f8b123c63eec5b53378720b6a8.png"></li><li>Add a subdomain or leave it blank. Select <strong>Type: A - IPv4 address</strong> if not previously selected and type in the Elastic IP retrieved from <a href="https://github.com/my-stolen-username/flavour-A-aws-setup#associate-elastic-ip-to-rancher-instance" target="_blank" rel="noopener noreferrer">https://github.com/my-stolen-username/flavour-A-aws-setup#associate-elastic-ip-to-rancher-instance</a>  in <strong>value</strong>.
<img alt="step6" src="/k8-proxy-documentation/assets/images/step6-a7c9d41f96aad218dd87bda3de5a9fe9.png"></li><li>Click on <strong>Create</strong></li><li>Select the newly created a record and Click on <strong>Test Record Set</strong> to check if the record is working or not.
<img alt="step8" src="/k8-proxy-documentation/assets/images/step8-3df912fd42e9fb5d97c88d0293673bc4.png"></li><li>Click on <strong>Get Response</strong>. You&#x27;ll see <strong>DNS response code:  NOERROR</strong> if it&#x27;s working.
<img alt="step9" src="/k8-proxy-documentation/assets/images/step9-568ecd4b63aed933a652390869c31fbd.png"></li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="iam-user-for-rancher"></a>IAM user for Rancher<a aria-hidden="true" tabindex="-1" class="hash-link" href="#iam-user-for-rancher" title="Direct link to heading">#</a></h2><ol><li>Open the IAM user console <a href="http://console.aws.amazon.com/iam" target="_blank" rel="noopener noreferrer">http://console.aws.amazon.com/iam</a></li><li>Click on Users
<img alt="step2" src="/k8-proxy-documentation/assets/images/step2-aa25554e38dd00c43873bc57e20505e2.png"></li><li>Click on <strong>Add User</strong></li><li>Give name to the group and select <strong>Programmatic access</strong>, choose <strong>Next: Permissions</strong><img alt="step4" src="/k8-proxy-documentation/assets/images/step4-42b0b5c383fa24ed0e510156cd202ee9.png"></li><li>Click on Create Group
<img alt="step5" src="/k8-proxy-documentation/assets/images/step5-4476bfc83f0334b2c8137ab751ef5968.png"></li><li>Type in the name of the group and search for <strong>AmazonEC2FullAccess</strong> and select it then click on <strong>Create group</strong><img alt="step6" src="/k8-proxy-documentation/assets/images/step6-76241e3306e7c6c85756776cc70b7a7e.png"></li><li>Select the newly created group, choose <strong>Next: Tags</strong></li><li>Add tags for the user i.e key rg-gw-dev name rancher-user, choose <strong>Next: Review</strong><img alt="step8" src="/k8-proxy-documentation/assets/images/step8-5b28af512a94dcbe487bfc76d87a4a4b.png"></li><li>Review then choose <strong>Create User</strong></li><li>Download the CSV or save the Access key ID and Secret access key which will be used later for rancher
<img alt="step10" src="/k8-proxy-documentation/assets/images/step10-f1928edea873861e6c3a6a92ac1ac250.png"></li><li>Close</li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="setting-up-rancher"></a>Setting up Rancher<a aria-hidden="true" tabindex="-1" class="hash-link" href="#setting-up-rancher" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="before-following-the-rancher-docs"></a>Before following the Rancher Docs<a aria-hidden="true" tabindex="-1" class="hash-link" href="#before-following-the-rancher-docs" title="Direct link to heading">#</a></h3><p>It is highly advised to have a domain for the Rancher instance or you&#x27;ll be facing tons of issues.
Use the <strong>Access key id</strong> and <strong>Secret access Key</strong> that was retrieved in <a href="https://github.com/my-stolen-username/flavour-A-aws-setup#iam-user-for-rancher" target="_blank" rel="noopener noreferrer">https://github.com/my-stolen-username/flavour-A-aws-setup#iam-user-for-rancher</a> when Rancher asks for it.
After you have everything required follow the steps below:</p><ol><li><p>SSH to Rancher instance using the keypair that you retrieved from <a href="https://github.com/my-stolen-username/flavour-A-aws-setup#setting-up-aws-ec2-instance-for-rancher-for-flavour-a" target="_blank" rel="noopener noreferrer">https://github.com/my-stolen-username/flavour-A-aws-setup#setting-up-aws-ec2-instance-for-rancher-for-flavour-a</a></p></li><li><p>Install docker</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">sudo apt-get update</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">sudo apt-get install apt-transport-https  ca-certificates  curl  gnupg-agent software-properties-common</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">sudo apt-key fingerprint 0EBFCD88</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">sudo apt-get update</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">sudo apt-get install docker-ce docker-ce-cli containerd.io</span></div></div></div></div></div></li><li><p>Deploy rancher server using docker</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"> docker run -d --restart=unless-stopped \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> -p 8080:80 -p 8443:443 \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> --privileged \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> rancher/rancher:latest \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> --no-cacerts</span></div></div></div></div></div></li><li><p>Install Apache2 and enable proxy and rewrite</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"> sudo apt-get install apache2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> sudo a2enmod proxy proxy_http proxy_wstunnel proxy_balancer proxy_connect headers</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> sudo a2enmod rewrite </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> sudo systemctl restart apache2</span></div></div></div></div></div></li><li><p>Edit the vhost conf file. Replace the  your-rancher-domain with domain configure in <a href="https://github.com/my-stolen-username/flavour-A-aws-setup#setting-up-route-53-for-rancher-instance" target="_blank" rel="noopener noreferrer">https://github.com/my-stolen-username/flavour-A-aws-setup#setting-up-route-53-for-rancher-instance</a> </p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">sudo vi /etc/apache2/sites-available/000-default.conf</span></div></div></div></div></div><p>Change it to </p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;VirtualHost *:80&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> ServerName &lt;your-rancher-domain&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> ProxyRequests Off</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> ProxyPreserveHost On</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> RewriteEngine On</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> RewriteCond %{HTTP:Connection} Upgrade [NC]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> RewriteCond %{HTTP:Upgrade} websocket [NC]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> RewriteRule /(.*) ws://0.0.0.0:8080/$1 [P,L]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> RequestHeader set X-Forwarded-Proto &quot;https&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> RequestHeader set X-Forwarded-Port &quot;443&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> &lt;Location /&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   ProxyPass &quot;http://0.0.0.0:8080/&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   ProxyPassReverse &quot;http://0.0.0.0:8080/&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> &lt;/Location&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> ErrorLog ${APACHE_LOG_DIR}/rancher-website-error.log</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> CustomLog ${APACHE_LOG_DIR}/rancher-website-access.log combined</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;/VirtualHost&gt;</span></div></div></div></div></div></li><li><p>Save and restart apache2</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">  sudo systemctl restart apache2</span></div></div></div></div></div></li><li><p>Install certbot <a href="https://certbot.eff.org/lets-encrypt/ubuntufocal-apache" target="_blank" rel="noopener noreferrer">https://certbot.eff.org/lets-encrypt/ubuntufocal-apache</a> and run </p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">sudo snap install core; sudo snap refresh core</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">sudo snap install --classic certbot</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">sudo ln -s /snap/bin/certbot /usr/bin/certbot</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">sudo certbot --apache</span></div></div></div></div></div></li><li><p>Select the domain that you added in your vhost</p></li><li><p>Open your rancher domain and follow from step 2. from the link <a href="https://github.com/k8-proxy/s-k8-proxy-rebuild/blob/master/stable-src/README.md#installation-steps-to-deploy-k8s-cluster-on-ec2-instances-using-rancher" target="_blank" rel="noopener noreferrer">https://github.com/k8-proxy/s-k8-proxy-rebuild/blob/master/stable-src/README.md#installation-steps-to-deploy-k8s-cluster-on-ec2-instances-using-rancher</a></p></li><li><p>A new instance will be created in EC2 instance console.</p></li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="creating-an-iam-user-for-docker-repository"></a>Creating an IAM user for Docker Repository<a aria-hidden="true" tabindex="-1" class="hash-link" href="#creating-an-iam-user-for-docker-repository" title="Direct link to heading">#</a></h2><ol><li><p>Open the IAM user console <a href="http://console.aws.amazon.com/iam" target="_blank" rel="noopener noreferrer">http://console.aws.amazon.com/iam</a></p></li><li><p>Click on Policies</p></li><li><p>Click on <strong>Create policy</strong></p></li><li><p>Select JSON and paste the following</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">   {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> &quot;Version&quot;: &quot;2012-10-17&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> &quot;Statement&quot;: [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">         &quot;Sid&quot;: &quot;VisualEditor0&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">         &quot;Effect&quot;: &quot;Allow&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">         &quot;Action&quot;: [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">             &quot;ecr:PutImageTagMutability&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">             &quot;ecr:StartImageScan&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">             &quot;ecr:ListTagsForResource&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">             &quot;ecr:UploadLayerPart&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">             &quot;ecr:BatchDeleteImage&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">             &quot;ecr:ListImages&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">             &quot;ecr:CompleteLayerUpload&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">             &quot;ecr:TagResource&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">             &quot;ecr:DescribeRepositories&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">             &quot;ecr:BatchCheckLayerAvailability&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">             &quot;ecr:GetLifecyclePolicy&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">             &quot;ecr:PutLifecyclePolicy&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">             &quot;ecr:DescribeImageScanFindings&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">             &quot;ecr:GetLifecyclePolicyPreview&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">             &quot;ecr:PutImageScanningConfiguration&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">             &quot;ecr:GetDownloadUrlForLayer&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">             &quot;ecr:GetAuthorizationToken&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">             &quot;ecr:DeleteLifecyclePolicy&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">             &quot;ecr:PutImage&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">             &quot;ecr:UntagResource&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">             &quot;ecr:BatchGetImage&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">             &quot;ecr:DescribeImages&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">             &quot;ecr:StartLifecyclePolicyPreview&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">             &quot;ecr:InitiateLayerUpload&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">             &quot;ecr:GetRepositoryPolicy&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">         ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">         &quot;Resource&quot;: &quot;*&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   ]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div></div></div></div></div><p><img alt="step4" src="/k8-proxy-documentation/assets/images/step4-ec27b824df8d6b284d48aecdbbcc4a35.png"></p></li><li><p>Click on <strong>Review Policy</strong></p></li><li><p>Name the policy and click on <strong>Create policy</strong>
<img alt="step6" src="/k8-proxy-documentation/assets/images/step6-a29e097602ebd2a7bb662244c189929e.png"></p></li><li><p>Click on Users</p></li><li><p>Click on Add User</p></li><li><p>Give name to the group and select <strong>Programmatic access</strong>, choose <strong>Next: Permissions</strong></p></li><li><p>Click on Create Group </p></li><li><p>Type in the name of the group and search for the policy you just created and select it then click on <strong>Create group</strong></p></li><li><p>Select the newly created group, choose <strong>Next: Tags</strong></p></li><li><p>Add tags for the user i.e key rg-gw-dev name ecr-user, choose <strong>Next: Review</strong></p></li><li><p>Review then choose <strong>Create User</strong></p></li><li><p>Download the CSV or save the Access key ID and Secret access key which will be used later for rancher</p></li><li><p>Close</p></li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="setting-up-repository-for-docker-in-aws"></a>Setting up Repository for Docker in AWS<a aria-hidden="true" tabindex="-1" class="hash-link" href="#setting-up-repository-for-docker-in-aws" title="Direct link to heading">#</a></h2><p>This setup assumes that the nginx, squid and icap applications are in the same repository,seperated by tags instead</p><ol><li><p>Open the ECR console <a href="https://console.aws.amazon.com/ecr/home" target="_blank" rel="noopener noreferrer">https://console.aws.amazon.com/ecr/home</a></p></li><li><p>Click on <strong>Create repository</strong></p></li><li><p>Type in a repository name then click on <strong>Create Repository</strong>, You&#x27;ll find a URI for your docker repo on the console copy it</p></li><li><p>In your client machine, follow these steps to install the aws cli <a href="https://docs.aws.amazon.com/cli/latest/userguide/install-cliv2.html" target="_blank" rel="noopener noreferrer">https://docs.aws.amazon.com/cli/latest/userguide/install-cliv2.html</a></p></li><li><p>Run the command and type in the AWS Access Key ID, AWS Secret Access Key, Default region name, and type in <strong>json</strong> in Default output format</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"> aws configure</span></div></div></div></div></div><p><img alt="step5" src="/k8-proxy-documentation/assets/images/step5-acd77e6a1065122e7242897318768f3a.png"></p></li><li><p>Install docker if you already have not.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"> sudo apt-get update</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> sudo apt-get install apt-transport-https  ca-certificates  curl  gnupg-agent software-properties-common</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> sudo apt-key fingerprint 0EBFCD88</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> sudo apt-get update</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> sudo apt-get install docker-ce docker-ce-cli containerd.io</span></div></div></div></div></div><p>Login to the ECR docker. Replace with URI with the docker-registry-url</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"> aws ecr get-login-password --region ap-southeast-1 | docker login --username AWS --password-stdin &lt;docker-registry-url&gt;</span></div></div></div></div></div></li><li><p>Install kubectl if you haven&#x27;t <a href="https://kubernetes.io/docs/tasks/tools/install-kubectl/" target="_blank" rel="noopener noreferrer">https://kubernetes.io/docs/tasks/tools/install-kubectl/</a>. Create a registry secret to give permission to the kubectl to push in ECR. Replace the AccountID with your AWS Account ID</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">   #</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   # RUN me where kubectl is available,&amp; make sure to replace account,region etc</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   #</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   ACCOUNT=&lt;ACCOUNT-ID&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   REGION=ap-southeast-1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   SECRET_NAME=${REGION}-ecr-registry</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   #</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   # Fetch token (which will expire in 12 hours)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   #</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   TOKEN=`aws ecr --region=$REGION get-authorization-token --output text --query authorizationData[].authorizationToken | base64 -d | cut -d: -f2`</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   #</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   # Create or replace registry secret</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   #</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   echo TOKEN</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   kubectl delete secret --ignore-not-found $SECRET_NAME</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   kubectl create secret docker-registry $SECRET_NAME \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   --docker-server=https://${ACCOUNT}.dkr.ecr.${REGION}.amazonaws.com \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   --docker-username=AWS \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   --docker-password=&quot;${TOKEN}&quot; \</span></div></div></div></div></div></li><li><p>Clone the <a href="https://github.com/k8-proxy/k8-reverse-proxy" target="_blank" rel="noopener noreferrer">https://github.com/k8-proxy/k8-reverse-proxy</a> repository and checkout develop branch</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">git clone https://github.com/k8-proxy/k8-reverse-proxy.git --recursive</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">cd stable-src</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">git checkout develop</span></div></div></div></div></div></li><li><p>Build the applications and push</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"> docker build nginx -t &lt;docker-registry-url&gt;:reverse-proxy-nginx-0.0.1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> docker build squid -t &lt;docker-registry-url&gt;:reverse-proxy-squid-0.0.1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> wget -O c-icap/Glasswall-Rebuild-SDK-Evaluation/Linux/Library/libglasswall.classic.so https://github.com/filetrust/Glasswall-Rebuild-SDK-Evaluation/releases/download/1.117/libglasswall.classic.so</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> docker build icap -t &lt;docker-registry-url&gt;:reverse-proxy-icap-0.0.1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> docker push &lt;docker-registry-url&gt;/reverse-proxy-nginx-0.0.1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> docker push &lt;docker-registry-url&gt;/reverse-proxy-squid-0.0.1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> docker push &lt;docker-registry-url&gt;/reverse-proxy-icap-0.0.1</span></div></div></div></div></div></li><li><p>Install helm if you haven&#x27;t already <a href="https://helm.sh/docs/intro/install/" target="_blank" rel="noopener noreferrer">https://helm.sh/docs/intro/install/</a></p></li><li><p>Clone the <a href="https://github.com/k8-proxy/s-k8-proxy-rebuild" target="_blank" rel="noopener noreferrer">https://github.com/k8-proxy/s-k8-proxy-rebuild</a> repository</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">git clone https://github.com/k8-proxy/s-k8-proxy-rebuild.git</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">cd stable-src</span></div></div></div></div></div></li><li><p>Run the helm command</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">helm upgrade --install \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  --set image.nginx.repository=&lt;docker-registry-url&gt; \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  --set image.nginx.tag=reverse-proxy-nginx-0.0.1 \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  --set image.squid.repository=&lt;docker-registry-url&gt; \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  --set image.squid.tag=reverse-proxy-squid-0.0.1 \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  --set image.icap.repository=&lt;docker-registry-url&gt; \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  --set image.icap.tag=reverse-proxy-icap-0.0.1 \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  reverse-proxy chart/</span></div></div></div></div></div></li><li><p>Verify that all pods(nginx, squid, icap) are running by executing below command</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"> kubectl get pods</span></div></div></div></div></div></li><li><p>Follow the doc after the <strong>kubectl get pods</strong> part <a href="https://github.com/k8-proxy/s-k8-proxy-rebuild/tree/master/stable-src#deploy-to-kubernetes" target="_blank" rel="noopener noreferrer">https://github.com/k8-proxy/s-k8-proxy-rebuild/tree/master/stable-src#deploy-to-kubernetes</a>. You&#x27;ll find the ip for your k8s node on the EC2 instance console.</p></li></ol></div></article><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/k8-proxy-documentation/docs/flavors/flavor-a/faq"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Flavor A FAQ</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/k8-proxy-documentation/docs/flavors/flavor-a/automated-setup"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Flavor A Automated Setup Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_3SO_"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#requirements" class="table-of-contents__link">Requirements</a><ul><li><a href="#client-machine-tools" class="table-of-contents__link">Client Machine tools</a></li><li><a href="#aws-requirements" class="table-of-contents__link">AWS requirements</a></li></ul></li><li><a href="#setting-up-aws-resource-group" class="table-of-contents__link">Setting up AWS Resource Group</a></li><li><a href="#setting-up-aws-ec2-instance-for-rancher-for-flavour-a" class="table-of-contents__link">Setting up AWS EC2 instance for Rancher for Flavour A</a></li><li><a href="#associate-elastic-ip-to-rancher-instance" class="table-of-contents__link">Associate Elastic IP to Rancher Instance</a></li><li><a href="#setting-up-route-53-for-rancher-instance" class="table-of-contents__link">Setting up Route 53 for Rancher Instance</a></li><li><a href="#iam-user-for-rancher" class="table-of-contents__link">IAM user for Rancher</a></li><li><a href="#setting-up-rancher" class="table-of-contents__link">Setting up Rancher</a><ul><li><a href="#before-following-the-rancher-docs" class="table-of-contents__link">Before following the Rancher Docs</a></li></ul></li><li><a href="#creating-an-iam-user-for-docker-repository" class="table-of-contents__link">Creating an IAM user for Docker Repository</a></li><li><a href="#setting-up-repository-for-docker-in-aws" class="table-of-contents__link">Setting up Repository for Docker in AWS</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/k8-proxy-documentation/docs/dashboards/websites/production">Getting Started</a></li></ul></div></div><div class="text--center"><div>Copyright Â© 2020 Glasswall Solutions Ltd. Built with Docusaurus.</div></div></div></footer></div>
<script src="/k8-proxy-documentation/styles.0550aa6a.js"></script>
<script src="/k8-proxy-documentation/runtime~main.de42f7e0.js"></script>
<script src="/k8-proxy-documentation/main.2a6c69ef.js"></script>
<script src="/k8-proxy-documentation/1.d6718f81.js"></script>
<script src="/k8-proxy-documentation/2.4f823a40.js"></script>
<script src="/k8-proxy-documentation/51.840a95c1.js"></script>
<script src="/k8-proxy-documentation/54.26f0564e.js"></script>
<script src="/k8-proxy-documentation/935f2afb.fba4e263.js"></script>
<script src="/k8-proxy-documentation/17896441.1837de2b.js"></script>
<script src="/k8-proxy-documentation/5573db2a.fc90c53e.js"></script>
</body>
</html>