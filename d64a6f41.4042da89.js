(window.webpackJsonp=window.webpackJsonp||[]).push([[45],{106:function(e,t,a){"use strict";a.r(t),a.d(t,"frontMatter",(function(){return r})),a.d(t,"metadata",(function(){return i})),a.d(t,"rightToc",(function(){return p})),a.d(t,"default",(function(){return b}));var n=a(2),l=a(6),o=(a(0),a(115)),r={title:"Sharepoint Online Solution Deployment",sidebar_label:"Sharepoint Online Solution Deployment"},i={unversionedId:"websites/sharepoint/online/sharepoint-online-solution-deployment",id:"websites/sharepoint/online/sharepoint-online-solution-deployment",isDocsHomePage:!1,title:"Sharepoint Online Solution Deployment",description:"This section will outline how to go about installing Glasswall SharePoint solutions to your environment. Glasswall SharePoint solution is offered in 2 flavors. They are:",source:"@site/docs/websites/sharepoint/online/sharepoint-online-solution-deployment.md",slug:"/websites/sharepoint/online/sharepoint-online-solution-deployment",permalink:"/k8-proxy-documentation/docs/websites/sharepoint/online/sharepoint-online-solution-deployment",version:"current",sidebar_label:"Sharepoint Online Solution Deployment",sidebar:"docs",previous:{title:"Sharepoint Online Solution Administration",permalink:"/k8-proxy-documentation/docs/websites/sharepoint/online/sharepoint-online-solution-administration"},next:{title:"Sharepoint Server VM Setup Overview",permalink:"/k8-proxy-documentation/docs/websites/sharepoint/server/server-setup/1. overview"}},p=[{value:"Glasswall - SharePoint Online - Solution Deployment",id:"glasswall---sharepoint-online---solution-deployment",children:[{value:"Prerequsites",id:"prerequsites",children:[]},{value:"GW SPO Extension Deployment",id:"gw-spo-extension-deployment",children:[]},{value:"GW FileHandler Web App Deployment",id:"gw-filehandler-web-app-deployment",children:[]}]}],s={rightToc:p};function b(e){var t=e.components,a=Object(l.a)(e,["components"]);return Object(o.b)("wrapper",Object(n.a)({},s,a,{components:t,mdxType:"MDXLayout"}),Object(o.b)("p",null,"This section will outline how to go about installing Glasswall SharePoint solutions to your environment. Glasswall SharePoint solution is offered in 2 flavors. They are:"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},Object(o.b)("strong",{parentName:"li"},"Glasswall - SharePoint Online - Solution")),Object(o.b)("li",{parentName:"ul"},Object(o.b)("strong",{parentName:"li"},"Glasswall - SharePoint Server - Solution")," - ",Object(o.b)("a",{parentName:"li",href:"/k8-proxy-documentation/docs/websites/sharepoint/server/sharepoint-server-solution-deployment"},"link"))),Object(o.b)("h2",{id:"glasswall---sharepoint-online---solution-deployment"},"Glasswall - SharePoint Online - Solution Deployment"),Object(o.b)("p",null,"GW SPO solution consists of the following components:"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},Object(o.b)("strong",{parentName:"li"},"GW SPO Extension")),Object(o.b)("li",{parentName:"ul"},Object(o.b)("strong",{parentName:"li"},"GW FileHandler Web App"))),Object(o.b)("p",null,"Both components need to be deployed to your environments (M365 + Azure) as described below."),Object(o.b)("h3",{id:"prerequsites"},"Prerequsites"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"You have setup your Microsoft account (M365 + Azure)."),Object(o.b)("li",{parentName:"ul"},"You have setup ",Object(o.b)("a",{parentName:"li",href:"https://docs.microsoft.com/en-us/azure/cost-management-billing/manage/create-subscription"},"Azure subscription"),"."),Object(o.b)("li",{parentName:"ul"},"Note: You can use 30-day free trial option by setting up account following ",Object(o.b)("a",{parentName:"li",href:"https://signup.microsoft.com/Signup?OfferId=B07A1127-DE83-4a6d-9F85-2C104BDAE8B4&dl=ENTERPRISEPACK&culture=en-US&country=US&ali=1"},"steps"),". This will setup both Sharepoint and Azure account, accessible on:",Object(o.b)("ul",{parentName:"li"},Object(o.b)("li",{parentName:"ul"},"Sharepoint: ",Object(o.b)("inlineCode",{parentName:"li"},"https://<yourTenant>.sharepoint.com/")),Object(o.b)("li",{parentName:"ul"},"Azure: ",Object(o.b)("inlineCode",{parentName:"li"},"https://portal.azure.com/"))))),Object(o.b)("h3",{id:"gw-spo-extension-deployment"},"GW SPO Extension Deployment"),Object(o.b)("p",null,"Following are the steps to deploy GW SPO Extension:"),Object(o.b)("h4",{id:"download-software"},"Download Software"),Object(o.b)("ol",null,Object(o.b)("li",{parentName:"ol"},"Go to ",Object(o.b)("strong",{parentName:"li"},"GW GitHub Releases")," page: ",Object(o.b)("a",{parentName:"li",href:"https://github.com/k8-proxy/gp-sharepoint-plugins/releases"},"https://github.com/k8-proxy/gp-sharepoint-plugins/releases"),"."),Object(o.b)("li",{parentName:"ol"},"Download the latest release of ",Object(o.b)("strong",{parentName:"li"},"GW SPO Extension")," - ",Object(o.b)("strong",{parentName:"li"},"GWO365FileHandlerExtension.zip"),"."),Object(o.b)("li",{parentName:"ol"},'Unzip to a local folder. You will find a package "glasswall-hide-download-ext.sppkg" which needs to be deployed.')),Object(o.b)("h4",{id:"create-app-catalog-site"},"Create App Catalog Site"),Object(o.b)("ol",null,Object(o.b)("li",{parentName:"ol"},"Go to the ",Object(o.b)("strong",{parentName:"li"},"SharePoint Admin Center")," by entering the following URL in your browser: ",Object(o.b)("strong",{parentName:"li"},"https://{tenant}-admin.sharepoint.com"),", where {tenant} is string next to your domain (ex. ",Object(o.b)("inlineCode",{parentName:"li"},"glasswall@share.onmicrosoft.com"),", {tenant} is ",Object(o.b)("inlineCode",{parentName:"li"},"share"),")"),Object(o.b)("li",{parentName:"ol"},"In the left sidebar, select ",Object(o.b)("strong",{parentName:"li"},"More features"),"."),Object(o.b)("li",{parentName:"ol"},"Locate the section ",Object(o.b)("strong",{parentName:"li"},"Apps")," and select ",Object(o.b)("strong",{parentName:"li"},"Open"),"."),Object(o.b)("li",{parentName:"ol"},"On the ",Object(o.b)("strong",{parentName:"li"},"Apps")," page, select ",Object(o.b)("strong",{parentName:"li"},"App Catalog"),"."),Object(o.b)("li",{parentName:"ol"},"Select ",Object(o.b)("strong",{parentName:"li"},"OK")," to create a new app catalog site."),Object(o.b)("li",{parentName:"ol"},"On the next page, enter the following details:"),Object(o.b)("li",{parentName:"ol"},Object(o.b)("strong",{parentName:"li"},"Title"),": Enter ",Object(o.b)("strong",{parentName:"li"},"App Catalog"),"."),Object(o.b)("li",{parentName:"ol"},Object(o.b)("strong",{parentName:"li"},"Web Site Address suffix"),": Enter your preferred suffix (at the empty field at the end of the line) for the app catalog; for example: ",Object(o.b)("strong",{parentName:"li"},"apps"),"."),Object(o.b)("li",{parentName:"ol"},Object(o.b)("strong",{parentName:"li"},"Administrator"),": Enter your ",Object(o.b)("strong",{parentName:"li"},"username"),", and then select to ",Object(o.b)("strong",{parentName:"li"},"Check Names")," and resolve the username."),Object(o.b)("li",{parentName:"ol"},"Select ",Object(o.b)("strong",{parentName:"li"},"OK")," to create the app catalog site."),Object(o.b)("li",{parentName:"ol"},"SharePoint creates the app catalog site, and you can see its progress in the SharePoint admin center."),Object(o.b)("li",{parentName:"ol"},"Click ",Object(o.b)("a",{parentName:"li",href:"https://docs.microsoft.com/en-us/sharepoint/dev/spfx/set-up-your-developer-tenant#create-app-catalog-site"},"here")," for more info.")),Object(o.b)("h4",{id:"deploy-package-to-app-catalog-site"},"Deploy Package to App Catalog Site"),Object(o.b)("ol",null,Object(o.b)("li",{parentName:"ol"},"Open your tenant's ",Object(o.b)("strong",{parentName:"li"},"app catalog site")," (i.e. https://{tenant}.sharepoint.com/sites/apps)."),Object(o.b)("li",{parentName:"ol"},"Click on ",Object(o.b)("strong",{parentName:"li"},"Apps for SharePoint")," on Left Navigation Menu."),Object(o.b)("li",{parentName:"ol"},"Click on ",Object(o.b)("strong",{parentName:"li"},"Upload"),". Browse and select ",Object(o.b)("strong",{parentName:"li"},"glasswall-hide-download-ext.sppkg")," package downloaded at earlier step from your local drive."),Object(o.b)("li",{parentName:"ol"},"Check ",Object(o.b)("strong",{parentName:"li"},"Make this solution available to all sites in the organization")," and click on ",Object(o.b)("strong",{parentName:"li"},"Deploy")," to deploy the solution tenant-wide."),Object(o.b)("li",{parentName:"ol"},"Verify deployment ended without any issues (check the last column in the table on the current page). In case there were errors, delete uploaded package and try again.")),Object(o.b)("h4",{id:"verify-solution"},"Verify Solution"),Object(o.b)("ol",null,Object(o.b)("li",{parentName:"ol"},"Navigate to SharePoint Online (O365) Site."),Object(o.b)("li",{parentName:"ol"},"Open any Document Library (make sure you have some files uploaded there)."),Object(o.b)("li",{parentName:"ol"},"Select any file (click on the checkbox) and then in the toolbar, you will not see the default 'Download' button anymore.")),Object(o.b)("h4",{id:"repository"},"Repository"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"GW SPO Extension: ",Object(o.b)("a",{parentName:"li",href:"https://github.com/k8-proxy/gp-sharepoint-plugins/tree/main/Online/glasswall-hide-download-ext"},"https://github.com/k8-proxy/gp-sharepoint-plugins/tree/main/Online/glasswall-hide-download-ext"),"  ")),Object(o.b)("h3",{id:"gw-filehandler-web-app-deployment"},"GW FileHandler Web App Deployment"),Object(o.b)("p",null,"Following are the steps to deploy GW FileHandler web app:"),Object(o.b)("h4",{id:"download-software-1"},"Download Software"),Object(o.b)("ol",null,Object(o.b)("li",{parentName:"ol"},"Go to GW GitHub releases page: ",Object(o.b)("a",{parentName:"li",href:"https://github.com/k8-proxy/gp-sharepoint-plugins/releases"},"https://github.com/k8-proxy/gp-sharepoint-plugins/releases"),"."),Object(o.b)("li",{parentName:"ol"},"Download the latest release of GW FileHandler web app - GWO365FileHandlerWebApp.zip."),Object(o.b)("li",{parentName:"ol"},"Unzip to a local folder. ")),Object(o.b)("h4",{id:"create-filehandler-web-app"},"Create FileHandler Web App"),Object(o.b)("ol",null,Object(o.b)("li",{parentName:"ol"},"Go to your ",Object(o.b)("a",{parentName:"li",href:"https://portal.azure.com/"},"Azure Portal"),"."),Object(o.b)("li",{parentName:"ol"},"Create a resource group. For r.g. rg-glasswallfilehandler-prod"),Object(o.b)("li",{parentName:"ol"},"Create a new web app with appropriate plan by selecting resource group created in step 2, clicking on ",Object(o.b)("inlineCode",{parentName:"li"},"Add")," button in top toolbar and selecting ",Object(o.b)("inlineCode",{parentName:"li"},"Web App")," from the list."),Object(o.b)("li",{parentName:"ol"},"For runtime stack choose ",Object(o.b)("inlineCode",{parentName:"li"},".Net 5")),Object(o.b)("li",{parentName:"ol"},"Carefully select proper plan. For test you can go with ",Object(o.b)("inlineCode",{parentName:"li"},"Free sku and size"),", last option."),Object(o.b)("li",{parentName:"ol"},"Example name for web app can be: ",Object(o.b)("strong",{parentName:"li"},"app-glasswallfilehandler-prod"),". Once the web app is created, make a note of the URI. For e.g. ",Object(o.b)("a",{parentName:"li",href:"https://app-glasswallfilehandler-prod.azurewebsites.net"},"https://app-glasswallfilehandler-prod.azurewebsites.net"))),Object(o.b)("h4",{id:"register-a-new-application"},"Register a new application"),Object(o.b)("p",null,"The following steps will allow you to register your file handler application.\nTo register a new application with Azure Active Directory, log into your ",Object(o.b)("a",{parentName:"p",href:"https://portal.azure.com"},Object(o.b)("strong",{parentName:"a"},"Azure Portal")),"."),Object(o.b)("ol",null,Object(o.b)("li",{parentName:"ol"},"Navigate to the ",Object(o.b)("strong",{parentName:"li"},"Azure Active Directory")," module."),Object(o.b)("li",{parentName:"ol"},"Select ",Object(o.b)("strong",{parentName:"li"},"App registrations")," and click ",Object(o.b)("strong",{parentName:"li"},"New application registration"),".",Object(o.b)("ol",{parentName:"li"},Object(o.b)("li",{parentName:"ol"},"Type the name of your file handler application. For e.g. ",Object(o.b)("strong",{parentName:"li"},"GlasswallFileHandlerApp")),Object(o.b)("li",{parentName:"ol"},"Ensure ",Object(o.b)("strong",{parentName:"li"},"Application Type")," is set to ",Object(o.b)("strong",{parentName:"li"},"Web app / API")),Object(o.b)("li",{parentName:"ol"},"Enter a sign-on URL for your application. This will be ",Object(o.b)("inlineCode",{parentName:"li"},"https://app-glasswallfilehandler-prod.azurewebsites.net"),"."),Object(o.b)("li",{parentName:"ol"},"Click ",Object(o.b)("strong",{parentName:"li"},"Create")," to create the app."))),Object(o.b)("li",{parentName:"ol"},"After the app has been created successfully, from Azure Active Directory, left side menu choose App registrations and select the app (created in step 2) from the list of applications."),Object(o.b)("li",{parentName:"ol"},"Make a note of ",Object(o.b)("strong",{parentName:"li"},"Application ID")," for the app you registered. "),Object(o.b)("li",{parentName:"ol"},"Make a note of the ",Object(o.b)("strong",{parentName:"li"},"Object ID")," for this application, since you will need this later to register the file handler manifest."),Object(o.b)("li",{parentName:"ol"},"Configure the application settings for this sample:",Object(o.b)("ol",{parentName:"li"},Object(o.b)("li",{parentName:"ol"},"Select ",Object(o.b)("strong",{parentName:"li"},"Authentication")," from left bar, choose to ",Object(o.b)("strong",{parentName:"li"},"Add platform"),", select ",Object(o.b)("strong",{parentName:"li"},"web")," and add ",Object(o.b)("strong",{parentName:"li"},"Redirect URIs")," as the one setup in 2.3 (e.g. ",Object(o.b)("inlineCode",{parentName:"li"},"https://app-glasswallfilehandler-prod.azurewebsites.net/signin-oidc"),") is added."),Object(o.b)("li",{parentName:"ol"},"Select ",Object(o.b)("strong",{parentName:"li"},"API Permissions"),", click to ",Object(o.b)("strong",{parentName:"li"},"Add a permission"),"."),Object(o.b)("li",{parentName:"ol"},"Choose ",Object(o.b)("strong",{parentName:"li"},"Microsoft Graph")," and select ",Object(o.b)("strong",{parentName:"li"},"Deligated permissions"),"."),Object(o.b)("li",{parentName:"ol"},"Under ",Object(o.b)("strong",{parentName:"li"},"Files")," find the permission ",Object(o.b)("strong",{parentName:"li"},"Have full access to all files user can access")," and check the box next to it, then click ",Object(o.b)("strong",{parentName:"li"},"Select"),", and then ",Object(o.b)("strong",{parentName:"li"},"Done"),"."))),Object(o.b)("li",{parentName:"ol"},"Select ",Object(o.b)("strong",{parentName:"li"},"Ceriticates and Secrets")," and choose to add ",Object(o.b)("strong",{parentName:"li"},"New Client Secret")," by entering a description for the key, selecting a duration, and then click ",Object(o.b)("strong",{parentName:"li"},"Save"),". Make a note of the ",Object(o.b)("inlineCode",{parentName:"li"},"Client Value")," and ",Object(o.b)("inlineCode",{parentName:"li"},"Client ID")," displayed, since it will only be displayed once.")),Object(o.b)("h4",{id:"register-the-file-handler-manifest"},"Register the file handler manifest"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"After registering your app with Azure Active Directory, you can upload the file handler manifest information into the application.")),Object(o.b)("ol",null,Object(o.b)("li",{parentName:"ol"},"Select ",Object(o.b)("strong",{parentName:"li"},"Manifest")," from left menu"),Object(o.b)("li",{parentName:"ol"},"In displayed editor under ",Object(o.b)("strong",{parentName:"li"},"Addins")," add below file handler manifest (make sure to change url to correspond to the one you added) and Save")),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre"},'[\n    {\n        "id": "<Enter New GUID here>",\n        "type": "FileHandler",\n        "properties": [\n            { "key": "version","value": "2"},\n            { "key": "appIcon", "value": "{\\"svg\\":\\"<Enter application icon here>\\" }"},\n            { "key": "actions", "value": "[{\\"type\\":\\"custom\\",\\"url\\":\\"https://app-glasswallfilehandler-prod.azurewebsites.net/filehandler/download\\",\\"displayName\\": \\"Download (Glasswall)\\",\\"shortDisplayName\\": \\"Download (Glasswall)\\", \\"availableOn\\":{\\"file\\":{\\"extensions\\":[\\"*\\"]}}}]"}\n        ]\n    }\n]\n')),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"For detailed instructions on how to upload the file handler manifest, see ",Object(o.b)("a",{parentName:"li",href:"https://docs.microsoft.com/en-us/onedrive/developer/file-handlers/register-manually"},"Registering file handlers"),".")),Object(o.b)("h4",{id:"update-filehandler-application-settings"},"Update FileHandler Application Settings"),Object(o.b)("p",null,"Following application settings of FileHandler web app configuration needs to be updated:"),Object(o.b)("ol",null,Object(o.b)("li",{parentName:"ol"},"AzureAd:ClientId - Client Id of the App registered with Azure Active Directory "),Object(o.b)("li",{parentName:"ol"},"AzureAd:ClientSecret - Client Secret created in App registered with Azure Active Directory "),Object(o.b)("li",{parentName:"ol"},"AzureAd:Domain - Domain of your O365 subscription. For e.g. glasswall.onmicrosoft.com."),Object(o.b)("li",{parentName:"ol"},"AzureAd:TenantId - Tenant id of your Azure Active Directory tenant.  "),Object(o.b)("li",{parentName:"ol"},"Glasswall:BaseUrl - Base url of your Glasswall rebuild api endpoint. For e.g. ",Object(o.b)("a",{parentName:"li",href:"https://glasswall.execute-api.us-west-2.amazonaws.com/Prod/rebuild/api"},"https://glasswall.execute-api.us-west-2.amazonaws.com/Prod/rebuild/api")),Object(o.b)("li",{parentName:"ol"},"Glasswall:ApiKey - Api Key to access the Glasswall rebuild api.")),Object(o.b)("h4",{id:"deploy-filehandler-code"},"Deploy FileHandler Code"),Object(o.b)("ol",null,Object(o.b)("li",{parentName:"ol"},"Navigate to local folder where FileHandler release was downloaded."),Object(o.b)("li",{parentName:"ol"},"Deploy the code to your Azure Web App.")),Object(o.b)("h4",{id:"verify-solution-1"},"Verify Solution"),Object(o.b)("ol",null,Object(o.b)("li",{parentName:"ol"},"Navigate to SharePoint Online (O365) Site."),Object(o.b)("li",{parentName:"ol"},"Open any Document Library."),Object(o.b)("li",{parentName:"ol"},"Select any file. "),Object(o.b)("li",{parentName:"ol"},"Download the file."),Object(o.b)("li",{parentName:"ol"},"The downloaded file will be rebuilt by Glasswall.")),Object(o.b)("h4",{id:"supported-browsers"},"Supported Browsers"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Edge, Chrome, Firefox, Brave, Opera (Mac & Windows)"),Object(o.b)("li",{parentName:"ul"},"Safari (Mac)")),Object(o.b)("h4",{id:"repository-1"},"Repository"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"File Handler : ",Object(o.b)("a",{parentName:"li",href:"https://github.com/k8-proxy/gp-sharepoint-plugins/tree/main/Online/glasswall.o365.filehandler/Net5"},"https://github.com/k8-proxy/gp-sharepoint-plugins/tree/main/Online/glasswall.o365.filehandler/Net5"),".")))}b.isMDXComponent=!0},115:function(e,t,a){"use strict";a.d(t,"a",(function(){return c})),a.d(t,"b",(function(){return m}));var n=a(0),l=a.n(n);function o(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){o(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function p(e,t){if(null==e)return{};var a,n,l=function(e,t){if(null==e)return{};var a,n,l={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(l[a]=e[a]);return l}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(l[a]=e[a])}return l}var s=l.a.createContext({}),b=function(e){var t=l.a.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},c=function(e){var t=b(e.components);return l.a.createElement(s.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return l.a.createElement(l.a.Fragment,{},t)}},u=l.a.forwardRef((function(e,t){var a=e.components,n=e.mdxType,o=e.originalType,r=e.parentName,s=p(e,["components","mdxType","originalType","parentName"]),c=b(a),u=n,m=c["".concat(r,".").concat(u)]||c[u]||d[u]||o;return a?l.a.createElement(m,i(i({ref:t},s),{},{components:a})):l.a.createElement(m,i({ref:t},s))}));function m(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var o=a.length,r=new Array(o);r[0]=u;var i={};for(var p in t)hasOwnProperty.call(t,p)&&(i[p]=t[p]);i.originalType=e,i.mdxType="string"==typeof e?e:n,r[1]=i;for(var s=2;s<o;s++)r[s]=a[s];return l.a.createElement.apply(null,r)}return l.a.createElement.apply(null,a)}u.displayName="MDXCreateElement"}}]);